function jsonPointer(a,b){this.d=a;this.dp=b}jsonPointer.prototype={text:function(){var a=function(a){var c=[];for(var d=0;d<a.length;d++)c.push("{"+b(a[d])+"}");return c.join(",")};var b=function(c){var d=[];for(var e in c)if(typeof c[e]=="object"){if(e.length)d.push('"'+e+'":['+a(c[e])+"]");else d.push('"'+e+'":{'+b(c[e])+"}")}else d.push('"'+e+'":"'+c[e]+'"');return d.join(",")};return"{"+b(this.d)+"}"},get:function(a){return this.d[a]},exists:function(){return!!this.d},content:function(){return this.d.content},each:function(a,b,c){var d=this.d[a];var e=new jsonPointer;if(d)for(var f=0;f<d.length;f++){e.d=d[f];b.apply(c,[e,f])}},get_all:function(){return this.d},sub:function(a){return new jsonPointer(this.d[a],this.d)},sub_exists:function(a){return!!this.d[a]},each_x:function(a,b,c,d,e){var f=this.d[a];var g=new jsonPointer(0,this.d);if(f)for(e=e||0;e<f.length;e++)if(f[e][b]){g.d=f[e];if(c.apply(d,[g,e])==-1)return}},up:function(a){return new jsonPointer(this.dp,this.d)},set:function(a,b){this.d[a]=b},clone:function(a){return new jsonPointer(this.d,this.dp)},through:function(a,b,c,d,e){var f=this.d[a];if(f.length)for(var g=0;g<f.length;g++){if(f[g][b]!=null&&f[g][b]!=""&&(!c||f[g][b]==c)){var h=new jsonPointer(f[g],this.d);d.apply(e,[h,g])}var i=this.d;this.d=f[g];if(this.sub_exists(a))this.through(a,b,c,d,e);this.d=i}}};dhtmlXTreeObject.prototype.loadJSArrayFile=function(file,afterCall){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){eval("var z="+arguments[4].xmlDoc.responseText);that.loadJSArray(z)},this,true,this.no_cashe);if(afterCall)this.XMLLoader.waitCall=afterCall;this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.loadCSV=function(a,b){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var c=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){c.loadCSVString(arguments[4].xmlDoc.responseText)},this,true,this.no_cashe);if(b)this.XMLLoader.waitCall=b;this.XMLLoader.loadXML(a)};dhtmlXTreeObject.prototype.loadJSArray=function(a,b){var c=[];for(var d=0;d<a.length;d++){if(!c[a[d][1]])c[a[d][1]]=[];c[a[d][1]].push({id:a[d][0],text:a[d][2]})}var e={id:this.rootId};var f=function(a,b){if(c[a.id]){a.item=c[a.id];for(var d=0;d<a.item.length;d++)b(a.item[d],b)}};f(e,f);this.loadJSONObject(e,b)};dhtmlXTreeObject.prototype.loadCSVString=function(a,b){var c=[];var d=a.split("\n");for(var e=0;e<d.length;e++){var f=d[e].split(",");if(!c[f[1]])c[f[1]]=[];c[f[1]].push({id:f[0],text:f[2]})}var g={id:this.rootId};var h=function(a,b){if(c[a.id]){a.item=c[a.id];for(var d=0;d<a.item.length;d++)b(a.item[d],b)}};h(g,h);this.loadJSONObject(g,b)};dhtmlXTreeObject.prototype.loadJSONObject=function(a,b){if(!this.parsCount)this.callEvent("onXLS",[this,null]);this.xmlstate=1;var c=new jsonPointer(a);this._parse(c);this._p=c;if(b)b()};dhtmlXTreeObject.prototype.loadJSON=function(file,afterCall){if(!this.parsCount)this.callEvent("onXLS",[this,this._ld_id]);this._ld_id=null;this.xmlstate=1;var that=this;this.XMLLoader=new dtmlXMLLoaderObject(function(){try{eval("var t="+arguments[4].xmlDoc.responseText)}catch(e){dhtmlxError.throwError("LoadXML","Incorrect JSON",[arguments[4].xmlDoc,this]);return}var p=new jsonPointer(t);that._parse(p);that._p=p},this,true,this.no_cashe);if(afterCall)this.XMLLoader.waitCall=afterCall;this.XMLLoader.loadXML(file)};dhtmlXTreeObject.prototype.serializeTreeToJSON=function(){var a=['{"id":"'+this.rootId+'", "item":['];var b=[];for(var c=0;c<this.htmlNode.childsCount;c++)b.push(this._serializeItemJSON(this.htmlNode.childNodes[c]));a.push(b.join(","));a.push("]}");return a.join("")};dhtmlXTreeObject.prototype._serializeItemJSON=function(a){var b=[];if(a.unParsed)return a.unParsed.text();if(this._selected.length)var c=this._selected[0].id;else c="";var d=a.span.innerHTML;if(this._xescapeEntities)for(var e=0;e<this._serEnts.length;e++)d=d.replace(this._serEnts[e][2],this._serEnts[e][1]);if(!this._xfullXML)b.push('{"id":"'+a.id+'", '+(this._getOpenState(a)==1?' "open":"1", ':"")+(c==a.id?' "select":"1",':"")+' "text":"'+d+'"'+(this.XMLsource&&a.XMLload==0?', "child":"1" ':""));else b.push('{"id":"'+a.id+'", '+(this._getOpenState(a)==1?' "open":"1", ':"")+(c==a.id?' "select":"1",':"")+' "text":"'+d+'", "im0":"'+a.images[0]+'", "im1":"'+a.images[1]+'", "im2":"'+a.images[2]+'" '+(a.acolor?', "aCol":"'+a.acolor+'" ':"")+(a.scolor?', "sCol":"'+a.scolor+'" ':"")+(a.checkstate==1?', "checked":"1" ':a.checkstate==2?', "checked":"-1"':"")+(a.closeable?', "closeable":"1" ':""));if(this._xuserData&&a._userdatalist){b.push(', "userdata":[');var f=a._userdatalist.split(",");var g=[];for(var e=0;e<f.length;e++)g.push('{"name":"'+f[e]+'" , "content":"'+a.userData["t_"+f[e]]+'" }');b.push(g.join(","));b.push("]")}if(a.childsCount){b.push(', "item":[');var g=[];for(var e=0;e<a.childsCount;e++)g.push(this._serializeItemJSON(a.childNodes[e]));b.push(g.join(","));b.push("]\n")}b.push("}\n");return b.join("")}
