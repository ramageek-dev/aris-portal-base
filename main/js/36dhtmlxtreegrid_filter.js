dhtmlXGridObject.prototype.setFiltrationLevel=function(a,b,c){this._tr_strfltr=a;this._tr_fltr_c=b;this._tr_fltr_d=c;this.refreshFilters()};dhtmlXGridObject.prototype.filterTreeBy=function(a,b,c){var d=this._h2;if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;if(this._f_rowsBuffer){if(!c){this._h2=this._f_rowsBuffer;if(this._fake)this._fake._h2=this._h2}}else this._f_rowsBuffer=this._h2;var e=true;this.dma(true);this._fbf={};if(typeof a=="object")for(var f=0;f<b.length;f++)this._filterTreeA(a[f],b[f]);else this._filterTreeA(a,b);this._fbf=null;this.dma(false);this._fix_filtered_images(this._h2,d);this._renderSort();this.callEvent("onGridReconstructed",[])};dhtmlXGridObject.prototype._filterTreeA=function(a,b){if(b=="")return;var c=true;if(typeof b=="function")c=false;else b=(b||"").toString().toLowerCase();var d=function(a,b,c){var e=c.get[a.parent.id];if(!e)e=d(a.parent,b,c);var c=f.get[a.id];if(!c){c={id:a.id,childs:[],level:a.level,parent:e,index:e.childs.length,image:a.image,state:a.state,buff:a.buff,has_kids:a.has_kids};e.childs.push(c);f.get[c.id]=c}return c};var e=this._fbf;var f=new dhtmlxHierarchy;var g;var h=this._tr_strfltr;var i=this;var j=function(a){for(var b=0;b<a.childs.length;b++)i.temp(a.childs[b])};switch(h.toString()){case"-2":g=function(a){if(e[a.id])return false;j(a);return true};break;case"-1":g=function(a){return!a.childs.length};break;default:g=function(a){return h==a.level};break}this.temp=function(i){if(i.id!=0&&g(i)){if(c?this._get_cell_value(i.buff,a).toString().toLowerCase().indexOf(b)==-1:!b(this._get_cell_value(i.buff,a),i.id)){e[i.id]=true;if(this._tr_fltr_c)d(i.parent,this._h2,f);return false}else{d(i,this._h2,f);if(i.childs&&h!=-2)this._h2.forEachChild(i.id,function(a){d(a,this._h2,f)},this);return true}}else{if(this._tr_fltr_d&&this._tr_strfltr>i.level&&i.id!=0)d(i,this._h2,f);j(i)}};this.temp(this._h2.get[0]);this._h2=f;if(this._fake)this._fake._h2=this._h2};dhtmlXGridObject.prototype._fix_filtered_images=function(a,b){a.forEachChild(0,function(a){if(!a.childs.length&&!a.has_kids){if(a.state!=dhtmlXGridObject._emptyLineImg){a.state=dhtmlXGridObject._emptyLineImg;a.update=true;this._updateTGRState(a)}}else{if(a.buff.tagName=="TR"){var c=b.get[a.id];if(c&&c.state!="blank")a.state=c.state;a.update=true;this._updateTGRState(a)}}},this)};dhtmlXGridObject.prototype.collectTreeValues=function(a){if(typeof this._tr_strfltr=="undefined")this._tr_strfltr=-1;this.dma(true);this._build_m_order();a=this._m_order?this._m_order[a]:a;var b={};var c=[];var e=this._f_rowsBuffer||this._h2;e.forEachChild(0,function(c){if(this._tr_strfltr==-2||this._tr_strfltr==-1&&!c.childs.length||this._tr_strfltr==c.level){var d=this._get_cell_value(c.buff,a);if(d)b[d]=true}},this);this.dma(false);var f=this.combos[a];for(d in b)if(b[d]===true)c.push(f?f.get(d)||d:d);return c.sort()};dhtmlXGridObject.prototype._in_header_stat_tree_total=function(a,b,c){var d=function(){var a=0;this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));a+=isNaN(d)?0:d},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100};this._stat_in_header(a,d,b,c,c)};dhtmlXGridObject.prototype._in_header_stat_tree_total_leaf=function(a,b,c){var d=function(){var a=0;this._h2.forEachChild(0,function(c){if(c.childs.length)return;var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));a+=isNaN(d)?0:d},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100};this._stat_in_header(a,d,b,c,c)};dhtmlXGridObject.prototype._in_header_stat_tree_multi_total=function(a,b,c){var d=c[1].split(":");c[1]="";var e=function(){var a=0;this._h2.forEachChild(0,function(b){var c=parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[0]))*parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[1]));a+=isNaN(c)?0:c},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100};this._stat_in_header(a,e,b,c,c)};dhtmlXGridObject.prototype._in_header_stat_tree_multi_total_leaf=function(a,b,c){var d=c[1].split(":");c[1]="";var e=function(){var a=0;this._h2.forEachChild(0,function(b){if(b.childs.length)return;var c=parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[0]))*parseFloat(this._get_cell_value(b.buff||this.rowsAr[b.id],d[1]));a+=isNaN(c)?0:c},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a*100)/100};this._stat_in_header(a,e,b,c,c)};dhtmlXGridObject.prototype._in_header_stat_tree_max=function(a,b,c){var d=function(){var a=-999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));if(!isNaN(d))a=Math.max(a,d)},this);return this._maskArr[b]?this._aplNF(a,b):a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_min=function(a,b,c){var d=function(){var a=999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));if(!isNaN(d))a=Math.min(a,d)},this);return this._maskArr[b]?this._aplNF(a,b):a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_average=function(a,b,c){var d=function(){var a=0;var c=0;this._h2.forEachChild(0,function(d){var e=parseFloat(this._get_cell_value(d.buff||this.rowsAr[d.id],b));a+=isNaN(e)?0:e;c++},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a/c*100)/100};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_max_leaf=function(a,b,c){var d=function(){var a=-999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){if(c.childs.length)return;var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));if(!isNaN(d))a=Math.max(a,d)},this);return this._maskArr[b]?this._aplNF(a,b):a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_min_leaf=function(a,b,c){var d=function(){var a=999999999;if(this.getRowsNum()==0)return"";this._h2.forEachChild(0,function(c){if(c.childs.length)return;var d=parseFloat(this._get_cell_value(c.buff||this.rowsAr[c.id],b));if(!isNaN(d))a=Math.min(a,d)},this);return this._maskArr[b]?this._aplNF(a,b):a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_average_leaf=function(a,b,c){var d=function(){var a=0;var c=0;this._h2.forEachChild(0,function(d){if(d.childs.length)return;var e=parseFloat(this._get_cell_value(d.buff||this.rowsAr[d.id],b));a+=isNaN(e)?0:e;c++},this);return this._maskArr[b]?this._aplNF(a,b):Math.round(a/c*100)/100};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_count=function(a,b,c){var d=function(){var a=0;this._h2.forEachChild(0,function(b){a++},this);return a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._in_header_stat_tree_count_leaf=function(a,b,c){var d=function(){var a=0;this._h2.forEachChild(0,function(b){if(!b.childs.length)a++},this);return a};this._stat_in_header(a,d,b,c)};dhtmlXGridObject.prototype._stat_in_header=function(a,b,c,d){var e=this;var f=function(){this.dma(true);a.innerHTML=(d[0]?d[0]:"")+b.call(this)+(d[1]?d[1]:"");this.dma(false);this.callEvent("onStatReady",[])};if(!this._stat_events){this._stat_events=[];this.attachEvent("onClearAll",function(){if(!this.hdr.rows[1]){for(var a=0;a<this._stat_events.length;a++)for(var b=0;b<4;b++)this.detachEvent(this._stat_events[a][b]);this._stat_events=[]}})}this._stat_events.push([this.attachEvent("onGridReconstructed",f),this.attachEvent("onXLE",f),this.attachEvent("onFilterEnd",f),this.attachEvent("onEditCell",function(a,b,d){if(a==2&&d==c)f.call(this);return true})]);a.innerHTML=""}
