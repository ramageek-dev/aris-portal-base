function xmlPointer(a){this.d=a}function dhtmlXTreeObject(a,b,c,d){if(_isIE)try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}if(typeof a!="object")this.parentObject=document.getElementById(a);else this.parentObject=a;this.parentObject.style.overflow="hidden";this._itim_dg=true;this.dlmtr=",";this.dropLower=false;this.enableIEImageFix();this.xmlstate=0;this.mytype="tree";this.smcheck=true;this.width=b;this.height=c;this.rootId=d;this.childCalc=null;this.def_img_x="18px";this.def_img_y="18px";this.def_line_img_x="18px";this.def_line_img_y="18px";this._dragged=new Array;this._selected=new Array;this.style_pointer="pointer";if(_isIE)this.style_pointer="hand";this._aimgs=true;this.htmlcA=" [";this.htmlcB="]";this.lWin=window;this.cMenu=0;this.mlitems=0;this.iconURL="";this.dadmode=0;this.slowParse=false;this.autoScroll=true;this.hfMode=0;this.nodeCut=new Array;this.XMLsource=0;this.XMLloadingWarning=0;this._idpull={};this._pullSize=0;this.treeLinesOn=true;this.tscheck=false;this.timgen=true;this.dpcpy=false;this._ld_id=null;this._oie_onXLE=[];this.imPath=window.dhx_globalImgPath||"";this.checkArray=new Array("iconUncheckAll.gif","iconCheckAll.gif","iconCheckGray.gif","iconUncheckDis.gif","iconCheckDis.gif","iconCheckDis.gif");this.radioArray=new Array("radio_off.gif","radio_on.gif","radio_on.gif","radio_off.gif","radio_on.gif","radio_on.gif");this.lineArray=new Array("line2.gif","line3.gif","line4.gif","blank.gif","blank.gif","line1.gif");this.minusArray=new Array("minus2.gif","minus3.gif","minus4.gif","minus.gif","minus5.gif");this.plusArray=new Array("plus2.gif","plus3.gif","plus4.gif","plus.gif","plus5.gif");this.imageArray=new Array("leaf.gif","folderOpen.gif","folderClosed.gif");this.cutImg=new Array(0,0,0);this.cutImage="but_cut.gif";dhtmlxEventable(this);this.dragger=new dhtmlDragAndDropObject;this.htmlNode=new dhtmlXTreeItemObject(this.rootId,"",0,this);this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display="none";this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className="hiddenRow";this.allTree=this._createSelf();this.allTree.appendChild(this.htmlNode.htmlNode);if(_isFF){this.allTree.childNodes[0].width="100%";this.allTree.childNodes[0].style.overflow="hidden"}var f=this;this.allTree.onselectstart=new Function("return false;");if(_isMacOS)this.allTree.oncontextmenu=function(a){return f._doContClick(a||window.event)};this.allTree.onmousedown=function(a){return f._doContClick(a||window.event)};this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(_isIE)this.preventIECashing(true);this.selectionBar=document.createElement("DIV");this.selectionBar.className="selectionBar";this.selectionBar.innerHTML=" ";this.selectionBar.style.display="none";this.allTree.appendChild(this.selectionBar);if(window.addEventListener)window.addEventListener("unload",function(){try{f.destructor()}catch(a){}},false);if(window.attachEvent)window.attachEvent("onunload",function(){try{f.destructor()}catch(a){}});this.setImagesPath=this.setImagePath;this.setIconsPath=this.setIconPath;if(dhtmlx.image_path)this.setImagePath(dhtmlx.image_path);if(dhtmlx.skin)this.setSkin(dhtmlx.skin);return this}function cObject(){return this}function dhtmlXTreeItemObject(a,b,c,d,e,f){this.htmlNode="";this.acolor="";this.scolor="";this.tr=0;this.childsCount=0;this.tempDOMM=0;this.tempDOMU=0;this.dragSpan=0;this.dragMove=0;this.span=0;this.closeble=1;this.childNodes=new Array;this.userData=new cObject;this.checkstate=0;this.treeNod=d;this.label=b;this.parentObject=c;this.actionHandler=e;this.images=new Array(d.imageArray[0],d.imageArray[1],d.imageArray[2]);this.id=d._globalIdStorageAdd(a,this);if(this.treeNod.checkBoxOff)this.htmlNode=this.treeNod._createItem(1,this,f);else this.htmlNode=this.treeNod._createItem(0,this,f);this.htmlNode.objBelong=this;return this}xmlPointer.prototype={text:function(){if(!_isFF)return this.d.xml;var a=new XMLSerializer;return a.serializeToString(this.d)},get:function(a){return this.d.getAttribute(a)},exists:function(){return!!this.d},content:function(){return this.d.firstChild?this.d.firstChild.data:""},each:function(a,b,c,d){var e=this.d.childNodes;var f=new xmlPointer;if(e.length)for(d=d||0;d<e.length;d++)if(e[d].tagName==a){f.d=e[d];if(b.apply(c,[f,d])==-1)return}},get_all:function(){var a={};var b=this.d.attributes;for(var c=0;c<b.length;c++)a[b[c].name]=b[c].value;return a},sub:function(a){var b=this.d.childNodes;var c=new xmlPointer;if(b.length)for(var d=0;d<b.length;d++)if(b[d].tagName==a){c.d=b[d];return c}},up:function(a){return new xmlPointer(this.d.parentNode)},set:function(a,b){this.d.setAttribute(a,b)},clone:function(a){return new xmlPointer(this.d)},sub_exists:function(a){var b=this.d.childNodes;if(b.length)for(var c=0;c<b.length;c++)if(b[c].tagName==a)return true;return false},through:function(a,b,c,d,e){var f=this.d.childNodes;if(f.length)for(var g=0;g<f.length;g++){if(f[g].tagName==a&&f[g].getAttribute(b)!=null&&f[g].getAttribute(b)!=""&&(!c||f[g].getAttribute(b)==c)){var h=new xmlPointer(f[g]);d.apply(e,[h,g])}var i=this.d;this.d=f[g];this.through(a,b,c,d,e);this.d=i}}};dhtmlXTreeObject.prototype.setDataMode=function(a){this._datamode=a};dhtmlXTreeObject.prototype._doContClick=function(a){if(a.button!=2){if(this._acMenu){if(this._acMenu.hideContextMenu)this._acMenu.hideContextMenu();else this.cMenu._contextEnd()}return true}var b=_isIE?a.srcElement:a.target;while(b&&b.tagName!="BODY"){if(b.parentObject)break;b=b.parentNode}if(!b||!b.parentObject)return true;var c=b.parentObject;if(!this.callEvent("onRightClick",[c.id,a]))(a.srcElement||a.target).oncontextmenu=function(a){(a||event).cancelBubble=true;return false};this._acMenu=c.cMenu||this.cMenu;if(this._acMenu){if(!this.callEvent("onBeforeContextMenu",[c.id]))return true;(a.srcElement||a.target).oncontextmenu=function(a){(a||event).cancelBubble=true;return false};if(this._acMenu.showContextMenu){var d=window.document.documentElement;var e=window.document.body;var f=new Array(d.scrollLeft||e.scrollLeft,d.scrollTop||e.scrollTop);if(_isIE){var g=a.clientX+f[0];var h=a.clientY+f[1]}else{var g=a.pageX;var h=a.pageY}this._acMenu.showContextMenu(g-1,h-1);this.contextID=c.id;a.cancelBubble=true;this._acMenu._skip_hide=true}else{b.contextMenuId=c.id;b.contextMenu=this._acMenu;b.a=this._acMenu._contextStart;b.a(b,a);b.a=null}return false}return true};dhtmlXTreeObject.prototype.enableIEImageFix=function(a){if(!a){this._getImg=function(a){return document.createElement(a==this.rootId?"div":"img")};this._setSrc=function(a,b){a.src=b};this._getSrc=function(a){return a.src}}else{this._getImg=function(){var a=document.createElement("DIV");a.innerHTML=" ";a.className="dhx_bg_img_fix";return a};this._setSrc=function(a,b){a.style.backgroundImage="url("+b+")"};this._getSrc=function(a){var b=a.style.backgroundImage;return b.substr(4,b.length-5)}}};dhtmlXTreeObject.prototype.destructor=function(){for(var a in this._idpull){var b=this._idpull[a];if(!b)continue;b.parentObject=null;b.treeNod=null;b.childNodes=null;b.span=null;b.tr.nodem=null;b.tr=null;b.htmlNode.objBelong=null;b.htmlNode=null;this._idpull[a]=null}this.parentObject.innerHTML="";if(this.XMLLoader)this.XMLLoader.destructor();this.allTree.onselectstart=null;this.allTree.oncontextmenu=null;this.allTree.onmousedown=null;for(var a in this){this[a]=null}};cObject.prototype=new Object;cObject.prototype.clone=function(){function a(){}a.prototype=this;return new a};dhtmlXTreeObject.prototype._globalIdStorageAdd=function(a,b){if(this._globalIdStorageFind(a,1,1)){a=a+"_"+(new Date).valueOf();return this._globalIdStorageAdd(a,b)}this._idpull[a]=b;this._pullSize++;return a};dhtmlXTreeObject.prototype._globalIdStorageSub=function(a){if(this._idpull[a]){this._unselectItem(this._idpull[a]);this._idpull[a]=null;this._pullSize--}if(this._locker&&this._locker[a])this._locker[a]=false};dhtmlXTreeObject.prototype._globalIdStorageFind=function(a,b,c,d){var e=this._idpull[a];if(e){if(e.unParsed&&!c){this.reParse(e,0)}if(this._srnd&&!e.htmlNode)this._buildSRND(e,c);if(d&&this._edsbpsA){for(var f=0;f<this._edsbpsA.length;f++)if(this._edsbpsA[f][2]==a){dhtmlxError.throwError("getItem","Requested item still in parsing process.",a);return null}}return e}if(this.slowParse&&a!=0&&!b)return this.preParse(a);else return null};dhtmlXTreeObject.prototype._getSubItemsXML=function(a){var b=[];a.each("item",function(a){b.push(a.get("id"))},this);return b.join(",")};dhtmlXTreeObject.prototype.enableSmartXMLParsing=function(a){this.slowParse=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.findXML=function(a,b,c){};dhtmlXTreeObject.prototype._getAllCheckedXML=function(a,b,c){var d=[];if(c==2)a.through("item","checked",c,function(a){d.push(a.get("id"))},this);if(c==1)a.through("item","id",null,function(a){if(a.get("checked")&&a.get("checked")!=-1)d.push(a.get("id"))},this);if(c==0)a.through("item","id",null,function(a){if(!a.get("checked")||a.get("checked")==0)d.push(a.get("id"))},this);return b+(b?",":"")+d.join(",");if(b)return b;else return""};dhtmlXTreeObject.prototype._setSubCheckedXML=function(a,b){var c=a?"1":"";b.through("item","id",null,function(a){a.set("checked",c)},this)};dhtmlXTreeObject.prototype._getAllScraggyItemsXML=function(a,b){var c=[];var d=function(a){if(!a.sub_exists("item"))c.push(a.get("id"));else a.each("item",d,this)};d(a);return c.join(",")};dhtmlXTreeObject.prototype._getAllFatItemsXML=function(a,b){var c=[];var d=function(a){if(!a.sub_exists("item"))return;c.push(a.get("id"));a.each("item",d,this)};d(a);return c.join(",")};dhtmlXTreeObject.prototype._getAllSubItemsXML=function(a,b,c){var b=[];c.through("item","id",null,function(a){b.push(a.get("id"))},this);return b.join(",")};dhtmlXTreeObject.prototype.reParse=function(a){var b=this;if(!this.parsCount)b.callEvent("onXLS",[b,a.id]);this.xmlstate=1;var c=a.unParsed;a.unParsed=0;this.XMLloadingWarning=1;var d=this.parsingOn;var e=this.waitUpdateXML;var f=this.parsedArray;this.parsedArray=new Array;this.waitUpdateXML=false;this.parsingOn=a.id;this.parsedArray=new Array;this.setCheckList="";this._parse(c,a.id,2);var g=this.setCheckList.split(this.dlmtr);for(var h=0;h<this.parsedArray.length;h++)a.htmlNode.childNodes[0].appendChild(this.parsedArray[h]);if(c.get("order")&&c.get("order")!="none")this._reorderBranch(a,c.get("order"),true);this.oldsmcheck=this.smcheck;this.smcheck=false;for(var i=0;i<g.length;i++)if(g[i])this.setCheck(g[i],1);this.smcheck=this.oldsmcheck;this.parsingOn=d;this.waitUpdateXML=e;this.parsedArray=f;this.XMLloadingWarning=0;this._redrawFrom(this,a);if(this._srnd&&!a._sready)this.prepareSR(a.id);this.xmlstate=0;return true};dhtmlXTreeObject.prototype.preParse=function(a){if(!a||!this._p)return null;var b=false;this._p.clone().through("item","id",a,function(a){this._globalIdStorageFind(a.up().get("id"));return b=true},this);if(b){var c=this._globalIdStorageFind(a,true,false);if(!c)dhtmlxError.throwError("getItem","The item "+a+" not operable. Seems you have non-unique|incorrect IDs in tree's XML.",a)}return c};dhtmlXTreeObject.prototype._escape=function(a){switch(this.utfesc){case"none":return a;break;case"utf8":return encodeURIComponent(a);break;default:return escape(a);break}};dhtmlXTreeObject.prototype._drawNewTr=function(a,b){var c=document.createElement("tr");var d=document.createElement("td");var e=document.createElement("td");d.appendChild(document.createTextNode(" "));e.colSpan=3;e.appendChild(a);c.appendChild(d);c.appendChild(e);return c};dhtmlXTreeObject.prototype.loadXMLString=function(a,b){var c=this;if(!this.parsCount)this.callEvent("onXLS",[c,null]);this.xmlstate=1;if(b)this.XMLLoader.waitCall=b;this.XMLLoader.loadXMLString(a)};dhtmlXTreeObject.prototype.loadXML=function(a,b){if(this._datamode&&this._datamode!="xml")return this["load"+this._datamode.toUpperCase()](a,b);var c=this;if(!this.parsCount)this.callEvent("onXLS",[c,this._ld_id]);this._ld_id=null;this.xmlstate=1;this.XMLLoader=new dtmlXMLLoaderObject(this._parseXMLTree,this,true,this.no_cashe);if(b)this.XMLLoader.waitCall=b;this.XMLLoader.loadXML(a)};dhtmlXTreeObject.prototype._attachChildNode=function(a,b,c,d,e,f,g,h,i,j,k){if(j&&j.parentObject)a=j.parentObject;if(a.XMLload==0&&this.XMLsource&&!this.XMLloadingWarning){a.XMLload=1;this._loadDynXML(a.id)}var l=a.childsCount;var m=a.childNodes;if(k){if(k.tr.previousSibling.previousSibling){j=k.tr.previousSibling.nodem}else h=h.replace("TOP","")+",TOP"}if(j){var n,o;for(n=0;n<l;n++)if(m[n]==j){for(o=l;o!=n;o--)m[1+o]=m[o];break}n++;l=n}if(h){var p=h.split(",");for(var q=0;q<p.length;q++){switch(p[q]){case"TOP":if(a.childsCount>0){j=new Object;j.tr=a.childNodes[0].tr.previousSibling}a._has_top=true;for(n=l;n>0;n--)m[n]=m[n-1];l=0;break}}}var r;if(!(r=this._idpull[b])||r.span!=-1){r=m[l]=new dhtmlXTreeItemObject(b,c,a,this,d,1);b=m[l].id;a.childsCount++}if(!r.htmlNode){r.label=c;r.htmlNode=this._createItem(this.checkBoxOff?1:0,r);r.htmlNode.objBelong=r}if(e)r.images[0]=e;if(f)r.images[1]=f;if(g)r.images[2]=g;var s=this._drawNewTr(r.htmlNode);if(this.XMLloadingWarning||this._hAdI)r.htmlNode.parentNode.parentNode.style.display="none";if(j&&j.tr.nextSibling)a.htmlNode.childNodes[0].insertBefore(s,j.tr.nextSibling);else if(this.parsingOn==a.id){this.parsedArray[this.parsedArray.length]=s}else a.htmlNode.childNodes[0].appendChild(s);if(j&&!j.span)j=null;if(this.XMLsource)if(i&&i!=0)r.XMLload=0;else r.XMLload=1;r.tr=s;s.nodem=r;if(a.itemId==0)s.childNodes[0].className="hiddenRow";if(a._r_logic||this._frbtr)this._setSrc(r.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0],this.imPath+this.radioArray[0]);if(h){var p=h.split(",");for(var q=0;q<p.length;q++){switch(p[q]){case"SELECT":this.selectItem(b,false);break;case"CALL":this.selectItem(b,true);break;case"CHILD":r.XMLload=0;break;case"CHECKED":if(this.XMLloadingWarning)this.setCheckList+=this.dlmtr+b;else this.setCheck(b,1);break;case"HCHECKED":this._setCheck(r,"unsure");break;case"OPEN":r.openMe=1;break}}}if(!this.XMLloadingWarning){if(this._getOpenState(a)<0&&!this._hAdI)this.openItem(a.id);if(j){this._correctPlus(j);this._correctLine(j)}this._correctPlus(a);this._correctLine(a);this._correctPlus(r);if(a.childsCount>=2){this._correctPlus(m[a.childsCount-2]);this._correctLine(m[a.childsCount-2])}if(a.childsCount!=2)this._correctPlus(m[0]);if(this.tscheck)this._correctCheckStates(a);if(this._onradh){if(this.xmlstate==1){var t=this.onXLE;this.onXLE=function(a){this._onradh(b);if(t)t(a)}}else this._onradh(b)}}return r};dhtmlXTreeObject.prototype.enableContextMenu=function(a){if(a)this.cMenu=a};dhtmlXTreeObject.prototype.setItemContextMenu=function(a,b){var c=a.toString().split(this.dlmtr);for(var d=0;d<c.length;d++){var e=this._globalIdStorageFind(c[d]);if(!e)continue;e.cMenu=b}};dhtmlXTreeObject.prototype.insertNewItem=function(a,b,c,d,e,f,g,h,i){var j=this._globalIdStorageFind(a);if(!j)return-1;var k=this._attachChildNode(j,b,c,d,e,f,g,h,i);if(!this.XMLloadingWarning&&this.childCalc)this._fixChildCountLabel(j);return k};dhtmlXTreeObject.prototype.insertNewChild=function(a,b,c,d,e,f,g,h,i){return this.insertNewItem(a,b,c,d,e,f,g,h,i)};dhtmlXTreeObject.prototype._parseXMLTree=function(a,b,c,d,e){var f=new xmlPointer(e.getXMLTopNode("tree"));a._parse(f);a._p=f};dhtmlXTreeObject.prototype._parseItem=function(a,b,c,d){var e;if(this._srnd&&(!this._idpull[e=a.get("id")]||!this._idpull[e].span)){this._addItemSRND(b.id,e,a);return}var f=a.get_all();if(typeof this.waitUpdateXML=="object"&&!this.waitUpdateXML[f.id]){this._parse(a,f.id,1);return}if(f.text===null||typeof f.text=="undefined"){f.text=a.sub("itemtext");if(f.text)f.text=f.text.content()}var g=[];if(f.select)g.push("SELECT");if(f.top)g.push("TOP");if(f.call)this.nodeAskingCall=f.id;if(f.checked==-1)g.push("HCHECKED");else if(f.checked)g.push("CHECKED");if(f.open)g.push("OPEN");if(this.waitUpdateXML){if(this._globalIdStorageFind(f.id))var h=this.updateItem(f.id,f.text,f.im0,f.im1,f.im2,f.checked);else{if(this.npl==0)g.push("TOP");else c=b.childNodes[this.npl];var h=this._attachChildNode(b,f.id,f.text,0,f.im0,f.im1,f.im2,g.join(","),f.child,0,c);c=null}}else var h=this._attachChildNode(b,f.id,f.text,0,f.im0,f.im1,f.im2,g.join(","),f.child,d||0,c);if(f.tooltip)h.span.parentNode.parentNode.title=f.tooltip;if(f.style)if(h.span.style.cssText)h.span.style.cssText+=";"+f.style;else h.span.setAttribute("style",h.span.getAttribute("style")+";"+f.style);if(f.radio)h._r_logic=true;if(f.nocheckbox){var i=h.span.parentNode.previousSibling.previousSibling;i.childNodes[0].style.display="none";if(window._KHTMLrv)i.style.display="none";h.nocheckbox=true}if(f.disabled){if(f.checked!=null)this._setCheck(h,f.checked);this.disableCheckbox(h,1)}h._acc=f.child||0;if(this.parserExtension)this.parserExtension._parseExtension.call(this,a,f,b?b.id:0);this.setItemColor(h,f.aCol,f.sCol);if(f.locked=="1")this.lockItem(h.id,true,true);if(f.imwidth||f.imheight)this.setIconSize(f.imwidth,f.imheight,h);if(f.closeable=="0"||f.closeable=="1")this.setItemCloseable(h,f.closeable);var j="";if(f.topoffset)this.setItemTopOffset(h,f.topoffset);if(!this.slowParse||typeof this.waitUpdateXML=="object"){if(a.sub_exists("item"))j=this._parse(a,f.id,1)}else{if(!h.childsCount&&a.sub_exists("item"))h.unParsed=a.clone();a.each("userdata",function(a){this.setUserData(f.id,a.get("name"),a.content())},this)}if(j!="")this.nodeAskingCall=j;a.each("userdata",function(b){this.setUserData(a.get("id"),b.get("name"),b.content())},this)};dhtmlXTreeObject.prototype._parse=function(a,b,c,d){if(this._srnd&&!this.parentObject.offsetHeight){var e=this;return window.setTimeout(function(){e._parse(a,b,c,d)},100)}if(!a.exists())return;this.skipLock=true;if(!b){b=a.get("id");if(a.get("radio"))this.htmlNode._r_logic=true;this.parsingOn=b;this.parsedArray=new Array;this.setCheckList="";this.nodeAskingCall=""}var f=this._globalIdStorageFind(b);if(!f)return dhtmlxError.throwError("DataStructure","XML refers to not existing parent");this.parsCount=this.parsCount?this.parsCount+1:1;this.XMLloadingWarning=1;if(f.childsCount&&!d&&!this._edsbps&&!f._has_top)var g=f.childNodes[f.childsCount-1];else var g=0;this.npl=0;a.each("item",function(e,h){f.XMLload=1;if(this._epgps&&this._epgpsC==this.npl){this._setNextPageSign(f,this.npl+1*(d||0),c,node);return-1}this._parseItem(e,f,g);if(this._edsbps&&this.npl==this._edsbpsC){this._distributedStart(a,h+1,b,c,f.childsCount);return-1}this.npl++},this,d);if(!c){a.each("userdata",function(b){this.setUserData(a.get("id"),b.get("name"),b.content())},this);f.XMLload=1;if(this.waitUpdateXML){this.waitUpdateXML=false;for(var h=f.childsCount-1;h>=0;h--)if(f.childNodes[h]._dmark)this.deleteItem(f.childNodes[h].id)}var i=this._globalIdStorageFind(this.parsingOn);for(var h=0;h<this.parsedArray.length;h++)f.htmlNode.childNodes[0].appendChild(this.parsedArray[h]);this.lastLoadedXMLId=b;this.XMLloadingWarning=0;var j=this.setCheckList.split(this.dlmtr);for(var k=0;k<j.length;k++)if(j[k])this.setCheck(j[k],1);if(this.XMLsource&&this.tscheck&&this.smcheck&&f.id!=this.rootId){if(f.checkstate===0)this._setSubChecked(0,f);else if(f.checkstate===1)this._setSubChecked(1,f)}this._redrawFrom(this,null,d);if(a.get("order")&&a.get("order")!="none")this._reorderBranch(f,a.get("order"),true);if(this.nodeAskingCall!="")this.callEvent("onClick",[this.nodeAskingCall,this.getSelectedItemId()]);if(this._branchUpdate)this._branchUpdateNext(a)}if(this.parsCount==1){this.parsingOn=null;if(this._srnd&&f.id!=this.rootId){this.prepareSR(f.id);if(this.XMLsource)this.openItem(f.id)}a.through("item","open",null,function(a){this.openItem(a.get("id"))},this);if(!this._edsbps||!this._edsbpsA.length){var l=this;window.setTimeout(function(){l.callEvent("onXLE",[l,b])},1);this.xmlstate=0}this.skipLock=false}this.parsCount--;var l=this;if(this._edsbps)window.setTimeout(function(){l._distributedStep(b)},this._edsbpsD);if(this._epgps&&d)this._setPrevPageSign(f,d||0,c,node);if(!c&&this.onXLE)this.onXLE(this,b);return this.nodeAskingCall};dhtmlXTreeObject.prototype._branchUpdateNext=function(a){a.each("item",function(a){var b=a.get("id");if(this._idpull[b]&&!this._idpull[b].XMLload)return;this._branchUpdate++;this.smartRefreshItem(a.get("id"),a)},this);this._branchUpdate--};dhtmlXTreeObject.prototype.checkUserData=function(a,b){if(a.nodeType==1&&a.tagName=="userdata"){var c=a.getAttribute("name");if(c&&a.childNodes[0])this.setUserData(b,c,a.childNodes[0].data)}};dhtmlXTreeObject.prototype._redrawFrom=function(a,b,c,d){if(!b){var e=a._globalIdStorageFind(a.lastLoadedXMLId);a.lastLoadedXMLId=-1;if(!e)return 0}else e=b;var f=0;for(var g=c?c-1:0;g<e.childsCount;g++){if(!this._branchUpdate||this._getOpenState(e)==1)if(!b||d==1)e.childNodes[g].htmlNode.parentNode.parentNode.style.display="";if(e.childNodes[g].openMe==1){this._openItem(e.childNodes[g]);e.childNodes[g].openMe=0}a._redrawFrom(a,e.childNodes[g]);if(this.childCalc!=null){if(e.childNodes[g].unParsed||!e.childNodes[g].XMLload&&this.XMLsource){if(e.childNodes[g]._acc)e.childNodes[g].span.innerHTML=e.childNodes[g].label+this.htmlcA+e.childNodes[g]._acc+this.htmlcB;else e.childNodes[g].span.innerHTML=e.childNodes[g].label}if(e.childNodes[g].childNodes.length&&this.childCalc){if(this.childCalc==1){e.childNodes[g].span.innerHTML=e.childNodes[g].label+this.htmlcA+e.childNodes[g].childsCount+this.htmlcB}if(this.childCalc==2){var h=e.childNodes[g].childsCount-(e.childNodes[g].pureChilds||0);if(h)e.childNodes[g].span.innerHTML=e.childNodes[g].label+this.htmlcA+h+this.htmlcB;if(e.pureChilds)e.pureChilds++;else e.pureChilds=1}if(this.childCalc==3){e.childNodes[g].span.innerHTML=e.childNodes[g].label+this.htmlcA+e.childNodes[g]._acc+this.htmlcB}if(this.childCalc==4){var h=e.childNodes[g]._acc;if(h)e.childNodes[g].span.innerHTML=e.childNodes[g].label+this.htmlcA+h+this.htmlcB}}else if(this.childCalc==4){f++}f+=e.childNodes[g]._acc;if(this.childCalc==3){f++}}}if(!e.unParsed&&(e.XMLload||!this.XMLsource))e._acc=f;a._correctLine(e);a._correctPlus(e);if(this.childCalc&&!b)a._fixChildCountLabel(e)};dhtmlXTreeObject.prototype._createSelf=function(){var a=document.createElement("div");a.className="containerTableStyle";a.style.width=this.width;a.style.height=this.height;this.parentObject.appendChild(a);return a};dhtmlXTreeObject.prototype._xcloseAll=function(a){if(a.unParsed)return;if(this.rootId!=a.id){var b=a.htmlNode.childNodes[0].childNodes;var c=b.length;for(var d=1;d<c;d++)b[d].style.display="none";this._correctPlus(a)}for(var d=0;d<a.childsCount;d++)if(a.childNodes[d].childsCount)this._xcloseAll(a.childNodes[d])};dhtmlXTreeObject.prototype._xopenAll=function(a){this._HideShow(a,2);for(var b=0;b<a.childsCount;b++)this._xopenAll(a.childNodes[b])};dhtmlXTreeObject.prototype._correctPlus=function(a){if(!a.htmlNode)return;var b=a.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild;var c=a.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0];var d=this.lineArray;if(this.XMLsource&&!a.XMLload){var d=this.plusArray;this._setSrc(c,this.iconURL+a.images[2]);if(this._txtimg)return b.innerHTML="[+]"}else if(a.childsCount||a.unParsed){if(a.htmlNode.childNodes[0].childNodes[1]&&a.htmlNode.childNodes[0].childNodes[1].style.display!="none"){if(!a.wsign)var d=this.minusArray;this._setSrc(c,this.iconURL+a.images[1]);if(this._txtimg)return b.innerHTML="[-]"}else{if(!a.wsign)var d=this.plusArray;this._setSrc(c,this.iconURL+a.images[2]);if(this._txtimg)return b.innerHTML="[+]"}}else{this._setSrc(c,this.iconURL+a.images[0])}var e=2;if(!a.treeNod.treeLinesOn)this._setSrc(b,this.imPath+d[3]);else{if(a.parentObject)e=this._getCountStatus(a.id,a.parentObject);this._setSrc(b,this.imPath+d[e])}};dhtmlXTreeObject.prototype._correctLine=function(a){if(!a.htmlNode)return;var b=a.parentObject;if(b)if(this._getLineStatus(a.id,b)==0||!this.treeLinesOn)for(var c=1;c<=a.childsCount;c++){if(!a.htmlNode.childNodes[0].childNodes[c])break;a.htmlNode.childNodes[0].childNodes[c].childNodes[0].style.backgroundImage="";a.htmlNode.childNodes[0].childNodes[c].childNodes[0].style.backgroundRepeat=""}else for(var c=1;c<=a.childsCount;c++){if(!a.htmlNode.childNodes[0].childNodes[c])break;a.htmlNode.childNodes[0].childNodes[c].childNodes[0].style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";a.htmlNode.childNodes[0].childNodes[c].childNodes[0].style.backgroundRepeat="repeat-y"}};dhtmlXTreeObject.prototype._getCountStatus=function(a,b){if(b.childsCount<=1){if(b.id==this.rootId)return 4;else return 0}if(b.childNodes[0].id==a)if(b.id==this.rootId)return 2;else return 1;if(b.childNodes[b.childsCount-1].id==a)return 0;return 1};dhtmlXTreeObject.prototype._getLineStatus=function(a,b){if(b.childNodes[b.childsCount-1].id==a)return 0;return 1};dhtmlXTreeObject.prototype._HideShow=function(a,b){if(this.XMLsource&&!a.XMLload){if(b==1)return;a.XMLload=1;this._loadDynXML(a.id);return}if(a.unParsed)this.reParse(a);var c=a.htmlNode.childNodes[0].childNodes;var d=c.length;if(d>1){if((c[1].style.display!="none"||b==1)&&b!=2){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0";nodestyle="none"}else nodestyle="";for(var e=1;e<d;e++)c[e].style.display=nodestyle}this._correctPlus(a)};dhtmlXTreeObject.prototype._getOpenState=function(a){var b=a.htmlNode.childNodes[0].childNodes;if(b.length<=1)return 0;if(b[1].style.display!="none")return 1;else return-1};dhtmlXTreeObject.prototype.onRowClick2=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onDblClick",[this.parentObject.id,a]))return false;if(this.parentObject.closeble&&this.parentObject.closeble!="0")a._HideShow(this.parentObject);else a._HideShow(this.parentObject,2);if(a.checkEvent("onOpenEnd"))if(!a.xmlstate)a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)]);else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}return false};dhtmlXTreeObject.prototype.onRowClick=function(){var a=this.parentObject.treeNod;if(!a.callEvent("onOpenStart",[this.parentObject.id,a._getOpenState(this.parentObject)]))return 0;if(this.parentObject.closeble&&this.parentObject.closeble!="0")a._HideShow(this.parentObject);else a._HideShow(this.parentObject,2);if(a.checkEvent("onOpenEnd"))if(!a.xmlstate)a.callEvent("onOpenEnd",[this.parentObject.id,a._getOpenState(this.parentObject)]);else{a._oie_onXLE.push(a.onXLE);a.onXLE=a._epnFHe}};dhtmlXTreeObject.prototype._epnFHe=function(a,b,c){if(b!=this.rootId)this.callEvent("onOpenEnd",[b,a.getOpenState(b)]);a.onXLE=a._oie_onXLE.pop();if(!c&&!a._oie_onXLE.length)if(a.onXLE)a.onXLE(a,b)};dhtmlXTreeObject.prototype.onRowClickDown=function(a){a=a||window.event;var b=this.parentObject.treeNod;b._selectItem(this.parentObject,a)};dhtmlXTreeObject.prototype.getSelectedItemId=function(){var a=new Array;for(var b=0;b<this._selected.length;b++)a[b]=this._selected[b].id;return a.join(this.dlmtr)};dhtmlXTreeObject.prototype._selectItem=function(a,b){if(this.checkEvent("onSelect"))this._onSSCFold=this.getSelectedItemId();if(!this._amsel||!b||!b.ctrlKey&&!b.metaKey&&!b.shiftKey)this._unselectItems();if(a.i_sel&&this._amsel&&b&&(b.ctrlKey||b.metaKey))this._unselectItem(a);else if(!a.i_sel&&(!this._amselS||this._selected.length==0||this._selected[0].parentObject==a.parentObject))if(this._amsel&&b&&b.shiftKey&&this._selected.length!=0&&this._selected[this._selected.length-1].parentObject==a.parentObject){var c=this._getIndex(this._selected[this._selected.length-1]);var d=this._getIndex(a);if(d<c){var e=c;c=d;d=e}for(var f=c;f<=d;f++)if(!a.parentObject.childNodes[f].i_sel)this._markItem(a.parentObject.childNodes[f])}else this._markItem(a);if(this.checkEvent("onSelect")){var g=this.getSelectedItemId();if(g!=this._onSSCFold)this.callEvent("onSelect",[g])}};dhtmlXTreeObject.prototype._markItem=function(a){if(a.scolor)a.span.style.color=a.scolor;a.span.className="selectedTreeRow";a.i_sel=true;this._selected[this._selected.length]=a};dhtmlXTreeObject.prototype.getIndexById=function(a){var b=this._globalIdStorageFind(a);if(!b)return null;return this._getIndex(b)};dhtmlXTreeObject.prototype._getIndex=function(a){var b=a.parentObject;for(var c=0;c<b.childsCount;c++)if(b.childNodes[c]==a)return c};dhtmlXTreeObject.prototype._unselectItem=function(a){if(a&&a.i_sel){a.span.className="standartTreeRow";if(a.acolor)a.span.style.color=a.acolor;a.i_sel=false;for(var b=0;b<this._selected.length;b++)if(!this._selected[b].i_sel){this._selected.splice(b,1);break}}};dhtmlXTreeObject.prototype._unselectItems=function(){for(var a=0;a<this._selected.length;a++){var b=this._selected[a];b.span.className="standartTreeRow";if(b.acolor)b.span.style.color=b.acolor;b.i_sel=false}this._selected=new Array};dhtmlXTreeObject.prototype.onRowSelect=function(a,b,c){a=a||window.event;var d=this.parentObject;if(b)d=b.parentObject;var e=d.treeNod;var f=e.getSelectedItemId();if(!a||!a.skipUnSel)e._selectItem(d,a);if(!c){if(d.actionHandler)d.actionHandler(d.id,f);else e.callEvent("onClick",[d.id,f])}};dhtmlXTreeObject.prototype._correctCheckStates=function(a){if(!this.tscheck)return;if(!a)return;if(a.id==this.rootId)return;var b=a.childNodes;var c=0;var d=0;if(a.childsCount==0)return;for(var e=0;e<a.childsCount;e++){if(b[e].dscheck)continue;if(b[e].checkstate==0)c=1;else if(b[e].checkstate==1)d=1;else{c=1;d=1;break}}if(c&&d)this._setCheck(a,"unsure");else if(c)this._setCheck(a,false);else this._setCheck(a,true);this._correctCheckStates(a.parentObject)};dhtmlXTreeObject.prototype.onCheckBoxClick=function(a){if(!this.treeNod.callEvent("onBeforeCheck",[this.parentObject.id,this.parentObject.checkstate]))return;if(this.parentObject.dscheck)return true;if(this.treeNod.tscheck)if(this.parentObject.checkstate==1)this.treeNod._setSubChecked(false,this.parentObject);else this.treeNod._setSubChecked(true,this.parentObject);else if(this.parentObject.checkstate==1)this.treeNod._setCheck(this.parentObject,false);else this.treeNod._setCheck(this.parentObject,true);this.treeNod._correctCheckStates(this.parentObject.parentObject);return this.treeNod.callEvent("onCheck",[this.parentObject.id,this.parentObject.checkstate])};dhtmlXTreeObject.prototype._createItem=function(a,b,c){var d=document.createElement("table");d.cellSpacing=0;d.cellPadding=0;d.border=0;if(this.hfMode)d.style.tableLayout="fixed";d.style.margin=0;d.style.padding=0;var e=document.createElement("tbody");var f=document.createElement("tr");var g=document.createElement("td");g.className="standartTreeImage";if(this._txtimg){var h=document.createElement("div");g.appendChild(h);h.className="dhx_tree_textSign"}else{var h=this._getImg(b.id);h.border="0";if(h.tagName=="IMG")h.align="absmiddle";g.appendChild(h);h.style.padding=0;h.style.margin=0;h.style.width=this.def_line_img_x;h.style.height=this.def_line_img_y}var i=document.createElement("td");var j=this._getImg(this.cBROf?this.rootId:b.id);j.checked=0;this._setSrc(j,this.imPath+this.checkArray[0]);j.style.width="16px";j.style.height="16px";if(!a)(!_isIE?i:j).style.display="none";i.appendChild(j);if(!this.cBROf&&j.tagName=="IMG")j.align="absmiddle";j.onclick=this.onCheckBoxClick;j.treeNod=this;j.parentObject=b;if(!window._KHTMLrv)i.width="20px";else i.width="16px";var k=document.createElement("td");k.className="standartTreeImage";var l=this._getImg(this.timgen?b.id:this.rootId);l.onmousedown=this._preventNsDrag;l.ondragstart=this._preventNsDrag;l.border="0";if(this._aimgs){l.parentObject=b;if(l.tagName=="IMG")l.align="absmiddle";l.onclick=this.onRowSelect}if(!c)this._setSrc(l,this.iconURL+this.imageArray[0]);k.appendChild(l);l.style.padding=0;l.style.margin=0;if(this.timgen){k.style.width=l.style.width=this.def_img_x;l.style.height=this.def_img_y}else{l.style.width="0px";l.style.height="0px";if(_isOpera||window._KHTMLrv)k.style.display="none"}var m=document.createElement("td");m.className="standartTreeRow";b.span=document.createElement("span");b.span.className="standartTreeRow";if(this.mlitems){b.span.style.width=this.mlitems;b.span.style.display="block"}else m.noWrap=true;if(_isIE&&_isIE>7)m.style.width="999999px";else if(!window._KHTMLrv)m.style.width="100%";b.span.innerHTML=b.label;m.appendChild(b.span);m.parentObject=b;g.parentObject=b;m.onclick=this.onRowSelect;g.onclick=this.onRowClick;m.ondblclick=this.onRowClick2;if(this.ettip)f.title=b.label;if(this.dragAndDropOff){if(this._aimgs){this.dragger.addDraggableItem(k,this);k.parentObject=b}this.dragger.addDraggableItem(m,this)}b.span.style.paddingLeft="5px";b.span.style.paddingRight="5px";m.style.verticalAlign="";m.style.fontSize="10pt";m.style.cursor=this.style_pointer;f.appendChild(g);f.appendChild(i);f.appendChild(k);f.appendChild(m);e.appendChild(f);d.appendChild(e);if(this.ehlt||this.checkEvent("onMouseIn")||this.checkEvent("onMouseOut")){f.onmousemove=this._itemMouseIn;f[_isIE?"onmouseleave":"onmouseout"]=this._itemMouseOut}return d};dhtmlXTreeObject.prototype.setImagePath=function(a){this.imPath=a;this.iconURL=a};dhtmlXTreeObject.prototype.setIconPath=function(a){this.iconURL=a};dhtmlXTreeObject.prototype._getLeafCount=function(a){var b=0;for(var c=0;c<a.childsCount;c++)if(a.childNodes[c].childsCount==0)b++;return b};dhtmlXTreeObject.prototype._getChildCounterValue=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;if(b.unParsed||!b.XMLload&&this.XMLsource)return b._acc;switch(this.childCalc){case 1:return b.childsCount;break;case 2:return this._getLeafCount(b);break;case 3:return b._acc;break;case 4:return b._acc;break}};dhtmlXTreeObject.prototype._fixChildCountLabel=function(a,b){if(this.childCalc==null)return;if(a.unParsed||!a.XMLload&&this.XMLsource){if(a._acc)a.span.innerHTML=a.label+this.htmlcA+a._acc+this.htmlcB;else a.span.innerHTML=a.label;return}switch(this.childCalc){case 1:if(a.childsCount!=0)a.span.innerHTML=a.label+this.htmlcA+a.childsCount+this.htmlcB;else a.span.innerHTML=a.label;break;case 2:var c=this._getLeafCount(a);if(c!=0)a.span.innerHTML=a.label+this.htmlcA+c+this.htmlcB;else a.span.innerHTML=a.label;break;case 3:if(a.childsCount!=0){var d=0;for(var e=0;e<a.childsCount;e++){if(!a.childNodes[e]._acc)a.childNodes[e]._acc=0;d+=a.childNodes[e]._acc*1}d+=a.childsCount*1;a.span.innerHTML=a.label+this.htmlcA+d+this.htmlcB;a._acc=d}else{a.span.innerHTML=a.label;a._acc=0}if(a.parentObject&&a.parentObject!=this.htmlNode)this._fixChildCountLabel(a.parentObject);break;case 4:if(a.childsCount!=0){var d=0;for(var e=0;e<a.childsCount;e++){if(!a.childNodes[e]._acc)a.childNodes[e]._acc=1;d+=a.childNodes[e]._acc*1}a.span.innerHTML=a.label+this.htmlcA+d+this.htmlcB;a._acc=d}else{a.span.innerHTML=a.label;a._acc=1}if(a.parentObject&&a.parentObject!=this.htmlNode)this._fixChildCountLabel(a.parentObject);break}};dhtmlXTreeObject.prototype.setChildCalcMode=function(a){switch(a){case"child":this.childCalc=1;break;case"leafs":this.childCalc=2;break;case"childrec":this.childCalc=3;break;case"leafsrec":this.childCalc=4;break;case"disabled":this.childCalc=null;break;default:this.childCalc=4}};dhtmlXTreeObject.prototype.setChildCalcHTML=function(a,b){this.htmlcA=a;this.htmlcB=b};dhtmlXTreeObject.prototype.setOnRightClickHandler=function(a){this.attachEvent("onRightClick",a)};dhtmlXTreeObject.prototype.setOnClickHandler=function(a){this.attachEvent("onClick",a)};dhtmlXTreeObject.prototype.setOnSelectStateChange=function(a){this.attachEvent("onSelect",a)};dhtmlXTreeObject.prototype.setXMLAutoLoading=function(a){this.XMLsource=a};dhtmlXTreeObject.prototype.setOnCheckHandler=function(a){this.attachEvent("onCheck",a)};dhtmlXTreeObject.prototype.setOnOpenHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenStartHandler=function(a){this.attachEvent("onOpenStart",a)};dhtmlXTreeObject.prototype.setOnOpenEndHandler=function(a){this.attachEvent("onOpenEnd",a)};dhtmlXTreeObject.prototype.setOnDblClickHandler=function(a){this.attachEvent("onDblClick",a)};dhtmlXTreeObject.prototype.openAllItems=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;this._xopenAll(b)};dhtmlXTreeObject.prototype.getOpenState=function(a){var b=this._globalIdStorageFind(a);if(!b)return"";return this._getOpenState(b)};dhtmlXTreeObject.prototype.closeAllItems=function(a){if(a===window.undefined)a=this.rootId;var b=this._globalIdStorageFind(a);if(!b)return 0;this._xcloseAll(b);this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype.setUserData=function(a,b,c){var d=this._globalIdStorageFind(a,0,true);if(!d)return;if(b=="hint")d.htmlNode.childNodes[0].childNodes[0].title=c;if(typeof d.userData["t_"+b]=="undefined"){if(!d._userdatalist)d._userdatalist=b;else d._userdatalist+=","+b}d.userData["t_"+b]=c};dhtmlXTreeObject.prototype.getUserData=function(a,b){var c=this._globalIdStorageFind(a,0,true);if(!c)return;return c.userData["t_"+b]};dhtmlXTreeObject.prototype.getItemColor=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;var c=new Object;if(b.acolor)c.acolor=b.acolor;if(b.scolor)c.scolor=b.scolor;return c};dhtmlXTreeObject.prototype.setItemColor=function(a,b,c){if(a&&a.span)var d=a;else var d=this._globalIdStorageFind(a);if(!d)return 0;else{if(d.i_sel){if(c)d.span.style.color=c}else{if(b)d.span.style.color=b}if(c)d.scolor=c;if(b)d.acolor=b}};dhtmlXTreeObject.prototype.getItemText=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;return b.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML};dhtmlXTreeObject.prototype.getParentId=function(a){var b=this._globalIdStorageFind(a);if(!b||!b.parentObject)return"";return b.parentObject.id};dhtmlXTreeObject.prototype.changeItemId=function(a,b){if(a==b)return;var c=this._globalIdStorageFind(a);if(!c)return 0;c.id=b;c.span.contextMenuId=b;this._idpull[b]=this._idpull[a];delete this._idpull[a]};dhtmlXTreeObject.prototype.doCut=function(){if(this.nodeCut)this.clearCut();this.nodeCut=(new Array).concat(this._selected);for(var a=0;a<this.nodeCut.length;a++){var b=this.nodeCut[a];b._cimgs=new Array;b._cimgs[0]=b.images[0];b._cimgs[1]=b.images[1];b._cimgs[2]=b.images[2];b.images[0]=b.images[1]=b.images[2]=this.cutImage;this._correctPlus(b)}};dhtmlXTreeObject.prototype.doPaste=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;for(var c=0;c<this.nodeCut.length;c++){if(this._checkPNodes(b,this.nodeCut[c]))continue;this._moveNode(this.nodeCut[c],b)}this.clearCut()};dhtmlXTreeObject.prototype.clearCut=function(){for(var a=0;a<this.nodeCut.length;a++){var b=this.nodeCut[a];b.images[0]=b._cimgs[0];b.images[1]=b._cimgs[1];b.images[2]=b._cimgs[2];this._correctPlus(b)}this.nodeCut=new Array};dhtmlXTreeObject.prototype._moveNode=function(a,b){var c=this.dadmodec;if(c==1){var d=b;if(this.dadmodefix<0){while(true){d=this._getPrevNode(d);if(d==-1){d=this.htmlNode;break}if(d.tr==0||d.tr.style.display==""||!d.parentObject)break}var e=d;var f=b}else{while(true){d=this._getNextNode(d);if(d==-1){d=this.htmlNode;break}if(d.tr.style.display==""||!d.parentObject)break}var f=d;var e=b}if(this._getNodeLevel(e,0)>this._getNodeLevel(f,0)){if(!this.dropLower)return this._moveNodeTo(a,e.parentObject);else if(f.id!=this.rootId)return this._moveNodeTo(a,f.parentObject,f);else return this._moveNodeTo(a,this.htmlNode,null)}else{return this._moveNodeTo(a,f.parentObject,f)}}else return this._moveNodeTo(a,b)};dhtmlXTreeObject.prototype._fixNodesCollection=function(a,b){var c=0;var d=0;var e=a.childNodes;var f=a.childsCount-1;if(b==e[f])return;for(var g=0;g<f;g++)if(e[g]==e[f]){e[g]=e[g+1];e[g+1]=e[f]}for(var g=0;g<f+1;g++){if(c){var h=e[g];e[g]=c;c=h}else if(e[g]==b){c=e[g];e[g]=e[f]}}};dhtmlXTreeObject.prototype._recreateBranch=function(a,b,c,d){var e;var f="";if(c){for(e=0;e<b.childsCount;e++)if(b.childNodes[e]==c)break;if(e!=0)c=b.childNodes[e-1];else{f="TOP";c=""}}var g=this._onradh;this._onradh=null;var h=this._attachChildNode(b,a.id,a.label,0,a.images[0],a.images[1],a.images[2],f,0,c);h._userdatalist=a._userdatalist;h.userData=a.userData.clone();h.XMLload=a.XMLload;if(g){this._onradh=g;this._onradh(h.id)}if(a.treeNod.dpcpy)a.treeNod._globalIdStorageFind(a.id);else h.unParsed=a.unParsed;this._correctPlus(h);for(var e=0;e<a.childsCount;e++)this._recreateBranch(a.childNodes[e],h,0,1);if(!d&&this.childCalc){this._redrawFrom(this,b)}return h};dhtmlXTreeObject.prototype._moveNodeTo=function(a,b,c){if(a.treeNod._nonTrivialNode)return a.treeNod._nonTrivialNode(this,b,c,a);if(b.mytype)var d=a.treeNod.lWin!=b.lWin;else var d=a.treeNod.lWin!=b.treeNod.lWin;if(!this.callEvent("onDrag",[a.id,b.id,c?c.id:null,a.treeNod,b.treeNod]))return false;if(b.XMLload==0&&this.XMLsource){b.XMLload=1;this._loadDynXML(b.id)}this.openItem(b.id);var e=a.treeNod;var f=a.parentObject.childsCount;var g=a.parentObject;if(d||e.dpcpy){var h=a.id;a=this._recreateBranch(a,b,c);if(!e.dpcpy)e.deleteItem(h)}else{var i=b.childsCount;var j=b.childNodes;if(i==0)b._open=true;e._unselectItem(a);j[i]=a;a.treeNod=b.treeNod;b.childsCount++;var k=this._drawNewTr(j[i].htmlNode);if(!c){b.htmlNode.childNodes[0].appendChild(k);if(this.dadmode==1)this._fixNodesCollection(b,c)}else{b.htmlNode.childNodes[0].insertBefore(k,c.tr);this._fixNodesCollection(b,c);j=b.childNodes}}if(!e.dpcpy&&!d){var l=a.tr;if(document.all&&navigator.appVersion.search(/MSIE\ 5\.0/gi)!=-1){window.setTimeout(function(){l.parentNode.removeChild(l)},250)}else a.parentObject.htmlNode.childNodes[0].removeChild(a.tr);if(!c||b!=a.parentObject){for(var m=0;m<g.childsCount;m++){if(g.childNodes[m].id==a.id){g.childNodes[m]=0;break}}}else g.childNodes[g.childsCount-1]=0;e._compressChildList(g.childsCount,g.childNodes);g.childsCount--}if(!d&&!e.dpcpy){a.tr=k;k.nodem=a;a.parentObject=b;if(e!=b.treeNod){if(a.treeNod._registerBranch(a,e))return;this._clearStyles(a);this._redrawFrom(this,a.parentObject)}this._correctPlus(b);this._correctLine(b);this._correctLine(a);this._correctPlus(a);if(c){this._correctPlus(c)}else if(b.childsCount>=2){this._correctPlus(j[b.childsCount-2]);this._correctLine(j[b.childsCount-2])}this._correctPlus(j[b.childsCount-1]);if(this.tscheck)this._correctCheckStates(b);if(e.tscheck)e._correctCheckStates(g)}if(f>1){e._correctPlus(g.childNodes[f-2]);e._correctLine(g.childNodes[f-2])}e._correctPlus(g);e._correctLine(g);this._fixChildCountLabel(b);e._fixChildCountLabel(g);this.callEvent("onDrop",[a.id,b.id,c?c.id:null,e,b.treeNod]);return a.id};dhtmlXTreeObject.prototype._clearStyles=function(a){if(!a.htmlNode)return;var b=a.htmlNode.childNodes[0].childNodes[0].childNodes[1];var c=b.nextSibling.nextSibling;a.span.innerHTML=a.label;a.i_sel=false;if(a._aimgs)this.dragger.removeDraggableItem(b.nextSibling);if(this.checkBoxOff){b.childNodes[0].style.display="";b.childNodes[0].onclick=this.onCheckBoxClick;this._setSrc(b.childNodes[0],this.imPath+this.checkArray[a.checkstate])}else b.childNodes[0].style.display="none";b.childNodes[0].treeNod=this;this.dragger.removeDraggableItem(c);if(this.dragAndDropOff)this.dragger.addDraggableItem(c,this);if(this._aimgs)this.dragger.addDraggableItem(b.nextSibling,this);c.childNodes[0].className="standartTreeRow";c.onclick=this.onRowSelect;c.ondblclick=this.onRowClick2;b.previousSibling.onclick=this.onRowClick;this._correctLine(a);this._correctPlus(a);for(var d=0;d<a.childsCount;d++)this._clearStyles(a.childNodes[d])};dhtmlXTreeObject.prototype._registerBranch=function(a,b){if(b)b._globalIdStorageSub(a.id);a.id=this._globalIdStorageAdd(a.id,a);a.treeNod=this;for(var c=0;c<a.childsCount;c++)this._registerBranch(a.childNodes[c],b);return 0};dhtmlXTreeObject.prototype.enableThreeStateCheckboxes=function(a){this.tscheck=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnMouseInHandler=function(a){this.ehlt=true;this.attachEvent("onMouseIn",a)};dhtmlXTreeObject.prototype.setOnMouseOutHandler=function(a){this.ehlt=true;this.attachEvent("onMouseOut",a)};dhtmlXTreeObject.prototype.enableMercyDrag=function(a){this.dpcpy=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableTreeImages=function(a){this.timgen=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableFixedMode=function(a){this.hfMode=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableCheckBoxes=function(a,b){this.checkBoxOff=convertStringToBoolean(a);this.cBROf=!(this.checkBoxOff||convertStringToBoolean(b))};dhtmlXTreeObject.prototype.setStdImages=function(a,b,c){this.imageArray[0]=a;this.imageArray[1]=b;this.imageArray[2]=c};dhtmlXTreeObject.prototype.enableTreeLines=function(a){this.treeLinesOn=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setImageArrays=function(a,b,c,d,e,f){switch(a){case"plus":this.plusArray[0]=b;this.plusArray[1]=c;this.plusArray[2]=d;this.plusArray[3]=e;this.plusArray[4]=f;break;case"minus":this.minusArray[0]=b;this.minusArray[1]=c;this.minusArray[2]=d;this.minusArray[3]=e;this.minusArray[4]=f;break}};dhtmlXTreeObject.prototype.openItem=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;else return this._openItem(b)};dhtmlXTreeObject.prototype._openItem=function(a){var b=this._getOpenState(a);if(b<0||this.XMLsource&&!a.XMLload){if(!this.callEvent("onOpenStart",[a.id,b]))return 0;this._HideShow(a,2);if(this.checkEvent("onOpenEnd")){if(this.onXLE==this._epnFHe)this._epnFHe(this,a.id,true);if(!this.xmlstate||!this.XMLsource)this.callEvent("onOpenEnd",[a.id,this._getOpenState(a)]);else{this._oie_onXLE.push(this.onXLE);this.onXLE=this._epnFHe}}}else if(this._srnd)this._HideShow(a,2);if(a.parentObject&&!this._skip_open_parent)this._openItem(a.parentObject)};dhtmlXTreeObject.prototype.closeItem=function(a){if(this.rootId==a)return 0;var b=this._globalIdStorageFind(a);if(!b)return 0;if(b.closeble)this._HideShow(b,1)};dhtmlXTreeObject.prototype.getLevel=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;return this._getNodeLevel(b,0)};dhtmlXTreeObject.prototype.setItemCloseable=function(a,b){b=convertStringToBoolean(b);if(a&&a.span)var c=a;else var c=this._globalIdStorageFind(a);if(!c)return 0;c.closeble=b};dhtmlXTreeObject.prototype._getNodeLevel=function(a,b){if(a.parentObject)return this._getNodeLevel(a.parentObject,b+1);return b};dhtmlXTreeObject.prototype.hasChildren=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;else{if(this.XMLsource&&!b.XMLload)return true;else return b.childsCount}};dhtmlXTreeObject.prototype._getLeafCount=function(a){var b=0;for(var c=0;c<a.childsCount;c++)if(a.childNodes[c].childsCount==0)b++;return b};dhtmlXTreeObject.prototype.setItemText=function(a,b,c){var d=this._globalIdStorageFind(a);if(!d)return 0;d.label=b;d.span.innerHTML=b;if(this.childCalc)this._fixChildCountLabel(d);d.span.parentNode.parentNode.title=c||""};dhtmlXTreeObject.prototype.getItemTooltip=function(a){var b=this._globalIdStorageFind(a);if(!b)return"";return b.span.parentNode.parentNode._dhx_title||b.span.parentNode.parentNode.title||""};dhtmlXTreeObject.prototype.refreshItem=function(a){if(!a)a=this.rootId;var b=this._globalIdStorageFind(a);this.deleteChildItems(a);this._loadDynXML(a)};dhtmlXTreeObject.prototype.setItemImage2=function(a,b,c,d){var e=this._globalIdStorageFind(a);if(!e)return 0;e.images[1]=c;e.images[2]=d;e.images[0]=b;this._correctPlus(e)};dhtmlXTreeObject.prototype.setItemImage=function(a,b,c){var d=this._globalIdStorageFind(a);if(!d)return 0;if(c){d.images[1]=b;d.images[2]=c}else d.images[0]=b;this._correctPlus(d)};dhtmlXTreeObject.prototype.getSubItems=function(a){var b=this._globalIdStorageFind(a,0,1);if(!b)return 0;if(b.unParsed)return this._getSubItemsXML(b.unParsed);var c="";for(i=0;i<b.childsCount;i++){if(!c)c=b.childNodes[i].id;else c+=this.dlmtr+b.childNodes[i].id}return c};dhtmlXTreeObject.prototype._getAllScraggyItems=function(a){var b="";for(var c=0;c<a.childsCount;c++){if(a.childNodes[c].unParsed||a.childNodes[c].childsCount>0){if(a.childNodes[c].unParsed)var d=this._getAllScraggyItemsXML(a.childNodes[c].unParsed,1);else var d=this._getAllScraggyItems(a.childNodes[c]);if(d)if(b)b+=this.dlmtr+d;else b=d}else if(!b)b=a.childNodes[c].id;else b+=this.dlmtr+a.childNodes[c].id}return b};dhtmlXTreeObject.prototype._getAllFatItems=function(a){var b="";for(var c=0;c<a.childsCount;c++){if(a.childNodes[c].unParsed||a.childNodes[c].childsCount>0){if(!b)b=a.childNodes[c].id;else b+=this.dlmtr+a.childNodes[c].id;if(a.childNodes[c].unParsed)var d=this._getAllFatItemsXML(a.childNodes[c].unParsed,1);else var d=this._getAllFatItems(a.childNodes[c]);if(d)b+=this.dlmtr+d}}return b};dhtmlXTreeObject.prototype._getAllSubItems=function(a,b,c){if(c)d=c;else{var d=this._globalIdStorageFind(a)}if(!d)return 0;b="";for(var e=0;e<d.childsCount;e++){if(!b)b=d.childNodes[e].id;else b+=this.dlmtr+d.childNodes[e].id;var f=this._getAllSubItems(0,b,d.childNodes[e]);if(f)b+=this.dlmtr+f}if(d.unParsed)b=this._getAllSubItemsXML(a,b,d.unParsed);return b};dhtmlXTreeObject.prototype.selectItem=function(a,b,c){b=convertStringToBoolean(b);var d=this._globalIdStorageFind(a);if(!d||!d.parentObject)return 0;if(this.XMLloadingWarning)d.parentObject.openMe=1;else this._openItem(d.parentObject);var e=null;if(c){e=new Object;e.ctrlKey=true;if(d.i_sel)e.skipUnSel=true}if(b)this.onRowSelect(e,d.htmlNode.childNodes[0].childNodes[0].childNodes[3],false);else this.onRowSelect(e,d.htmlNode.childNodes[0].childNodes[0].childNodes[3],true)};dhtmlXTreeObject.prototype.getSelectedItemText=function(){var a=new Array;for(var b=0;b<this._selected.length;b++)a[b]=this._selected[b].span.innerHTML;return a.join(this.dlmtr)};dhtmlXTreeObject.prototype._compressChildList=function(a,b){a--;for(var c=0;c<a;c++){if(b[c]==0){b[c]=b[c+1];b[c+1]=0}}};dhtmlXTreeObject.prototype._deleteNode=function(a,b,c){if(!b||!b.parentObject)return 0;var d=0;var e=0;if(b.tr.nextSibling)d=b.tr.nextSibling.nodem;if(b.tr.previousSibling)e=b.tr.previousSibling.nodem;var f=b.parentObject;var g=f.childsCount;var h=f.childNodes;for(var i=0;i<g;i++){if(h[i].id==a){if(!c)f.htmlNode.childNodes[0].removeChild(h[i].tr);h[i]=0;break}}this._compressChildList(g,h);if(!c){f.childsCount--}if(d){this._correctPlus(d);this._correctLine(d)}if(e){this._correctPlus(e);this._correctLine(e)}if(this.tscheck)this._correctCheckStates(f);if(!c){this._globalIdStorageRecSub(b)}};dhtmlXTreeObject.prototype.setCheck=function(a,b){var c=this._globalIdStorageFind(a,0,1);if(!c)return;if(b==="unsure")this._setCheck(c,b);else{b=convertStringToBoolean(b);if(this.tscheck&&this.smcheck)this._setSubChecked(b,c);else this._setCheck(c,b)}if(this.smcheck)this._correctCheckStates(c.parentObject)};dhtmlXTreeObject.prototype._setCheck=function(a,b){if(!a)return;if((a.parentObject._r_logic||this._frbtr)&&b)if(this._frbtrs){if(this._frbtrL)this.setCheck(this._frbtrL.id,0);this._frbtrL=a}else for(var c=0;c<a.parentObject.childsCount;c++)this._setCheck(a.parentObject.childNodes[c],0);var d=a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(b=="unsure")a.checkstate=2;else if(b)a.checkstate=1;else a.checkstate=0;if(a.dscheck)a.checkstate=a.dscheck;this._setSrc(d,this.imPath+(a.parentObject._r_logic||this._frbtr?this.radioArray:this.checkArray)[a.checkstate])};dhtmlXTreeObject.prototype.setSubChecked=function(a,b){var c=this._globalIdStorageFind(a);this._setSubChecked(b,c);this._correctCheckStates(c.parentObject)};dhtmlXTreeObject.prototype._setSubChecked=function(a,b){a=convertStringToBoolean(a);if(!b)return;if((b.parentObject._r_logic||this._frbtr)&&a)for(var c=0;c<b.parentObject.childsCount;c++)this._setSubChecked(0,b.parentObject.childNodes[c]);if(b.unParsed)this._setSubCheckedXML(a,b.unParsed);if(b._r_logic||this._frbtr)this._setSubChecked(a,b.childNodes[0]);else for(var c=0;c<b.childsCount;c++){this._setSubChecked(a,b.childNodes[c])}var d=b.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];if(a)b.checkstate=1;else b.checkstate=0;if(b.dscheck)b.checkstate=b.dscheck;this._setSrc(d,this.imPath+(b.parentObject._r_logic||this._frbtr?this.radioArray:this.checkArray)[b.checkstate])};dhtmlXTreeObject.prototype.isItemChecked=function(a){var b=this._globalIdStorageFind(a);if(!b)return;return b.checkstate};dhtmlXTreeObject.prototype.deleteChildItems=function(a){var b=this._globalIdStorageFind(a);if(!b)return;var c=b.childsCount;for(var d=0;d<c;d++){this._deleteNode(b.childNodes[0].id,b.childNodes[0])}};dhtmlXTreeObject.prototype.deleteItem=function(a,b){if(!this._onrdlh||this._onrdlh(a)){var c=this._deleteItem(a,b);this._fixChildCountLabel(c)}this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"};dhtmlXTreeObject.prototype._deleteItem=function(a,b,c){b=convertStringToBoolean(b);var d=this._globalIdStorageFind(a);if(!d)return;var e=this.getParentId(a);var f=d.parentObject;this._deleteNode(a,d,c);this._correctPlus(f);this._correctLine(f);if(b&&e!=this.rootId)this.selectItem(e,1);return f};dhtmlXTreeObject.prototype._globalIdStorageRecSub=function(a){for(var b=0;b<a.childsCount;b++){this._globalIdStorageRecSub(a.childNodes[b]);this._globalIdStorageSub(a.childNodes[b].id)}this._globalIdStorageSub(a.id);var c=a;c.span=null;c.tr.nodem=null;c.tr=null;c.htmlNode=null};dhtmlXTreeObject.prototype.insertNewNext=function(a,b,c,d,e,f,g,h,i){var j=this._globalIdStorageFind(a);if(!j||!j.parentObject)return 0;var k=this._attachChildNode(0,b,c,d,e,f,g,h,i,j);if(!this.XMLloadingWarning&&this.childCalc)this._fixChildCountLabel(j.parentObject);return k};dhtmlXTreeObject.prototype.getItemIdByIndex=function(a,b){var c=this._globalIdStorageFind(a);if(!c||b>=c.childsCount)return null;return c.childNodes[b].id};dhtmlXTreeObject.prototype.getChildItemIdByIndex=function(a,b){var c=this._globalIdStorageFind(a);if(!c||b>=c.childsCount)return null;return c.childNodes[b].id};dhtmlXTreeObject.prototype.setDragHandler=function(a){this.attachEvent("onDrag",a)};dhtmlXTreeObject.prototype._clearMove=function(){if(this._lastMark){this._lastMark.className=this._lastMark.className.replace(/dragAndDropRow/g,"");this._lastMark=null}this.selectionBar.style.display="none";this.allTree.className=this.allTree.className.replace(" selectionBox","")};dhtmlXTreeObject.prototype.enableDragAndDrop=function(a,b){if(a=="temporary_disabled"){this.dADTempOff=false;a=true}else this.dADTempOff=true;this.dragAndDropOff=convertStringToBoolean(a);if(this.dragAndDropOff)this.dragger.addDragLanding(this.allTree,this);if(arguments.length>1)this._ddronr=!convertStringToBoolean(b)};dhtmlXTreeObject.prototype._setMove=function(a,b,c){if(a.parentObject.span){var d=getAbsoluteTop(a);var e=getAbsoluteTop(this.allTree)-this.allTree.scrollTop;this.dadmodec=this.dadmode;this.dadmodefix=0;if(this.dadmode==2){var f=c-d+this.allTree.scrollTop+(document.body.scrollTop||document.documentElement.scrollTop)-2-a.offsetHeight/2;if(Math.abs(f)-a.offsetHeight/6>0){this.dadmodec=1;if(f<0)this.dadmodefix=0-a.offsetHeight}else this.dadmodec=0}if(this.dadmodec==0){var g=a.parentObject.span;g.className+=" dragAndDropRow";this._lastMark=g}else{this._clearMove();this.selectionBar.style.top=d-e+((parseInt(a.parentObject.span.parentNode.previousSibling.childNodes[0].style.height)||18)-1)+this.dadmodefix+"px";this.selectionBar.style.left="5px";if(this.allTree.offsetWidth>20)this.selectionBar.style.width=this.allTree.offsetWidth-(_isFF?30:25)+"px";this.selectionBar.style.display=""}this._autoScroll(null,d,e)}};dhtmlXTreeObject.prototype._autoScroll=function(a,b,c){if(this.autoScroll){if(a){b=getAbsoluteTop(a);c=getAbsoluteTop(this.allTree)}if(b-c-parseInt(this.allTree.scrollTop)>parseInt(this.allTree.offsetHeight)-50)this.allTree.scrollTop=parseInt(this.allTree.scrollTop)+20;if(b-c<parseInt(this.allTree.scrollTop)+30)this.allTree.scrollTop=parseInt(this.allTree.scrollTop)-20}};dhtmlXTreeObject.prototype._createDragNode=function(a,b){if(!this.dADTempOff)return null;var c=a.parentObject;if(!this.callEvent("onBeforeDrag",[c.id]))return null;if(!c.i_sel)this._selectItem(c,b);this._checkMSelectionLogic();var d=document.createElement("div");var e=new Array;if(this._itim_dg)for(var f=0;f<this._selected.length;f++)e[f]="<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='"+this._getSrc(this._selected[f].span.parentNode.previousSibling.childNodes[0])+"'></td><td>"+this._selected[f].span.innerHTML+"</td></tr></table>";else e=this.getSelectedItemText().split(this.dlmtr);d.innerHTML=e.join("");d.style.position="absolute";d.className="dragSpanDiv";this._dragged=(new Array).concat(this._selected);return d};dhtmlXTreeObject.prototype._focusNode=function(a){var b=getAbsoluteTop(a.htmlNode)-getAbsoluteTop(this.allTree);if(b>this.allTree.scrollTop+this.allTree.offsetHeight-30||b<this.allTree.scrollTop)this.allTree.scrollTop=b};dhtmlXTreeObject.prototype._preventNsDrag=function(a){if(a&&a.preventDefault){a.preventDefault();return false}return false};dhtmlXTreeObject.prototype._drag=function(a,b,c){if(this._autoOpenTimer)clearTimeout(this._autoOpenTimer);if(!c.parentObject){c=this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];this.dadmodec=0}this._clearMove();var d=a.parentObject.treeNod;if(d&&d._clearMove)d._clearMove("");if(!this.dragMove||this.dragMove()){if(!d||!d._clearMove||!d._dragged)var e=new Array(a.parentObject);else var e=d._dragged;var f=c.parentObject;for(var g=0;g<e.length;g++){var h=this._moveNode(e[g],f);if(this.dadmodec&&h!==false)f=this._globalIdStorageFind(h,true,true);if(h&&!this._sADnD)this.selectItem(h,0,1)}}if(d)d._dragged=new Array};dhtmlXTreeObject.prototype._dragIn=function(a,b,c,d){if(!this.dADTempOff)return 0;var e=b.parentObject;var f=a.parentObject;if(!f&&this._ddronr)return;if(!this.callEvent("onDragIn",[e.id,f?f.id:null,e.treeNod,this])){if(f)this._autoScroll(a);return 0}if(!f)this.allTree.className+=" selectionBox";else{if(e.childNodes==null){this._setMove(a,c,d);return a}var g=e.treeNod;for(var h=0;h<g._dragged.length;h++)if(this._checkPNodes(f,g._dragged[h])){this._autoScroll(a);return 0}this.selectionBar.parentNode.removeChild(this.selectionBar);f.span.parentNode.appendChild(this.selectionBar);this._setMove(a,c,d);if(this._getOpenState(f)<=0){this._autoOpenId=f.id;this._autoOpenTimer=window.setTimeout(new callerFunction(this._autoOpenItem,this),1e3)}}return a};dhtmlXTreeObject.prototype._autoOpenItem=function(a,b){b.openItem(b._autoOpenId)};dhtmlXTreeObject.prototype._dragOut=function(a){this._clearMove();if(this._autoOpenTimer)clearTimeout(this._autoOpenTimer)};dhtmlXTreeObject.prototype._getNextNode=function(a,b){if(!b&&a.childsCount)return a.childNodes[0];if(a==this.htmlNode)return-1;if(a.tr&&a.tr.nextSibling&&a.tr.nextSibling.nodem)return a.tr.nextSibling.nodem;return this._getNextNode(a.parentObject,true)};dhtmlXTreeObject.prototype._lastChild=function(a){if(a.childsCount)return this._lastChild(a.childNodes[a.childsCount-1]);else return a};dhtmlXTreeObject.prototype._getPrevNode=function(a,b){if(a.tr&&a.tr.previousSibling&&a.tr.previousSibling.nodem)return this._lastChild(a.tr.previousSibling.nodem);if(a.parentObject)return a.parentObject;else return-1};dhtmlXTreeObject.prototype.findItem=function(a,b,c){var d=this._findNodeByLabel(a,b,c?this.htmlNode:null);if(d){this.selectItem(d.id,true);this._focusNode(d);return d.id}else return null};dhtmlXTreeObject.prototype.findItemIdByLabel=function(a,b,c){var d=this._findNodeByLabel(a,b,c?this.htmlNode:null);if(d)return d.id;else return null};dhtmlXTreeObject.prototype.findStrInXML=function(a,b,c){if(!a.childNodes&&a.item)return this.findStrInJSON(a,b,c);for(var d=0;d<a.childNodes.length;d++){if(a.childNodes[d].nodeType==1){var e=a.childNodes[d].getAttribute(b);if(!e&&a.childNodes[d].tagName=="itemtext")e=a.childNodes[d].firstChild.data;if(e&&e.toLowerCase().search(c)!=-1)return true;if(this.findStrInXML(a.childNodes[d],b,c))return true}}return false};dhtmlXTreeObject.prototype.findStrInJSON=function(a,b,c){for(var d=0;d<a.item.length;d++){var e=a.item[d].text;if(e&&e.toLowerCase().search(c)!=-1)return true;if(this.item[d].item&&this.findStrInJSON(a.item[d],b,c))return true}return false};dhtmlXTreeObject.prototype._findNodeByLabel=function(a,b,c){var a=a.replace(new RegExp("^( )+"),"").replace(new RegExp("( )+$"),"");a=new RegExp(a.replace(/([\?\*\+\\\[\]\(\)]{1})/gi,"\\$1").replace(/ /gi,".*"),"gi");if(!c){c=this._selected[0];if(!c)c=this.htmlNode}var d=c;if(!b){if(c.unParsed&&this.findStrInXML(c.unParsed.d,"text",a))this.reParse(c);c=this._getNextNode(d);if(c==-1)c=this.htmlNode.childNodes[0]}else{var e=this._getPrevNode(d);if(e==-1)e=this._lastChild(this.htmlNode);if(e.unParsed&&this.findStrInXML(e.unParsed.d,"text",a)){this.reParse(e);c=this._getPrevNode(d)}else c=e;if(c==-1)c=this._lastChild(this.htmlNode)}while(c&&c!=d){if(c.label&&c.label.search(a)!=-1)return c;if(!b){if(c==-1){if(d==this.htmlNode)break;c=this.htmlNode.childNodes[0]}if(c.unParsed&&this.findStrInXML(c.unParsed.d,"text",a))this.reParse(c);c=this._getNextNode(c);if(c==-1)c=this.htmlNode}else{var e=this._getPrevNode(c);if(e==-1)e=this._lastChild(this.htmlNode);if(e.unParsed&&this.findStrInXML(e.unParsed.d,"text",a)){this.reParse(e);c=this._getPrevNode(c)}else c=e;if(c==-1)c=this._lastChild(this.htmlNode)}}return null};dhtmlXTreeObject.prototype.moveItem=function(a,b,c,d){var e=this._globalIdStorageFind(a);if(!e)return 0;switch(b){case"right":alert("Not supported yet");break;case"item_child":var f=(d||this)._globalIdStorageFind(c);if(!f)return 0;(d||this)._moveNodeTo(e,f,0);break;case"item_sibling":var f=(d||this)._globalIdStorageFind(c);if(!f)return 0;(d||this)._moveNodeTo(e,f.parentObject,f);break;case"item_sibling_next":var f=(d||this)._globalIdStorageFind(c);if(!f)return 0;if(f.tr&&f.tr.nextSibling&&f.tr.nextSibling.nodem)(d||this)._moveNodeTo(e,f.parentObject,f.tr.nextSibling.nodem);else(d||this)._moveNodeTo(e,f.parentObject);break;case"left":if(e.parentObject.parentObject)this._moveNodeTo(e,e.parentObject.parentObject,e.parentObject);break;case"up":var g=this._getPrevNode(e);if(g==-1||!g.parentObject)return;this._moveNodeTo(e,g.parentObject,g);break;case"up_strict":var g=this._getIndex(e);if(g!=0)this._moveNodeTo(e,e.parentObject,e.parentObject.childNodes[g-1]);break;case"down_strict":var g=this._getIndex(e);var h=e.parentObject.childsCount-2;if(g==h)this._moveNodeTo(e,e.parentObject);else if(g<h)this._moveNodeTo(e,e.parentObject,e.parentObject.childNodes[g+2]);break;case"down":var g=this._getNextNode(this._lastChild(e));if(g==-1||!g.parentObject)return;if(g.parentObject==e.parentObject)var g=this._getNextNode(g);if(g==-1){this._moveNodeTo(e,e.parentObject)}else{if(g==-1||!g.parentObject)return;this._moveNodeTo(e,g.parentObject,g)}break}if(_isIE&&_isIE<8){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}};dhtmlXTreeObject.prototype.setDragBehavior=function(a,b){this._sADnD=!convertStringToBoolean(b);switch(a){case"child":this.dadmode=0;break;case"sibling":this.dadmode=1;break;case"complex":this.dadmode=2;break}};dhtmlXTreeObject.prototype._loadDynXML=function(a,b){b=b||this.XMLsource;var c=(new Date).valueOf();this._ld_id=a;if(this.xmlalb=="function"){if(b)b(this._escape(a))}else if(this.xmlalb=="name")this.loadXML(b+this._escape(a));else if(this.xmlalb=="xmlname")this.loadXML(b+this._escape(a)+".xml?uid="+c);else this.loadXML(b+getUrlSymbol(b)+"uid="+c+"&id="+this._escape(a))};dhtmlXTreeObject.prototype.enableMultiselection=function(a,b){this._amsel=convertStringToBoolean(a);this._amselS=convertStringToBoolean(b)};dhtmlXTreeObject.prototype._checkMSelectionLogic=function(){var a=new Array;for(var b=0;b<this._selected.length;b++)for(var c=0;c<this._selected.length;c++)if(b!=c&&this._checkPNodes(this._selected[c],this._selected[b]))a[a.length]=this._selected[c];for(var b=0;b<a.length;b++)this._unselectItem(a[b])};dhtmlXTreeObject.prototype._checkPNodes=function(a,b){if(b==a)return 1;if(a.parentObject)return this._checkPNodes(a.parentObject,b);else return 0};dhtmlXTreeObject.prototype.enableDistributedParsing=function(a,b,c){this._edsbps=convertStringToBoolean(a);this._edsbpsA=new Array;this._edsbpsC=b||10;this._edsbpsD=c||250};dhtmlXTreeObject.prototype.getDistributedParsingState=function(){return!(!this._edsbpsA||!this._edsbpsA.length)};dhtmlXTreeObject.prototype.getItemParsingState=function(a){var b=this._globalIdStorageFind(a,true,true);if(!b)return 0;if(this._edsbpsA)for(var c=0;c<this._edsbpsA.length;c++)if(this._edsbpsA[c][2]==a)return-1;return 1};dhtmlXTreeObject.prototype._distributedStart=function(a,b,c,d,e){if(!this._edsbpsA)this._edsbpsA=new Array;this._edsbpsA[this._edsbpsA.length]=[a,b,c,d,e]};dhtmlXTreeObject.prototype._distributedStep=function(a){var b=this;if(!this._edsbpsA||!this._edsbpsA.length){b.XMLloadingWarning=0;return}var c=this._edsbpsA[0];this.parsedArray=new Array;this._parse(c[0],c[2],c[3],c[1]);var d=this._globalIdStorageFind(c[2]);this._redrawFrom(this,d,c[4],this._getOpenState(d));var e=this.setCheckList.split(this.dlmtr);for(var f=0;f<e.length;f++)if(e[f])this.setCheck(e[f],1);this._edsbpsA=(new Array).concat(this._edsbpsA.slice(1));if(!this._edsbpsA.length){window.setTimeout(function(){if(b.onXLE)b.onXLE(b,a);b.callEvent("onXLE",[b,a])},1);b.xmlstate=0}};dhtmlXTreeObject.prototype.enablePaging=function(a,b){this._epgps=convertStringToBoolean(a);this._epgpsC=b||50};dhtmlXTreeObject.prototype._setPrevPageSign=function(a,b,c,d){var e=document.createElement("DIV");e.innerHTML="Previous "+this._epgpsC+" items";e.className="dhx_next_button";var f=this;e.onclick=function(){f._prevPageCall(this)};e._pageData=[a,b,c,d];var g=a.childNodes[0];var h=g.span.parentNode.parentNode.parentNode.parentNode.parentNode;h.insertBefore(e,h.firstChild)};dhtmlXTreeObject.prototype._setNextPageSign=function(a,b,c,d){var e=document.createElement("DIV");e.innerHTML="Next "+this._epgpsC+" items";e.className="dhx_next_button";var f=this;e.onclick=function(){f._nextPageCall(this)};e._pageData=[a,b,c,d];var g=a.childNodes[a.childsCount-1];g.span.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e)};dhtmlXTreeObject.prototype._nextPageCall=function(a){tree.deleteChildItems(a._pageData[0].id);a.parentNode.removeChild(a);var b=this._getOpenState(a._pageData[0]);this._parseXMLTree(this,a._pageData[3],a._pageData[0].id,a._pageData[2],null,a._pageData[1]);this._redrawFrom(this,a._pageData[0],0);if(b>-1)this._openItem(a._pageData[0]);a._pageData=null};dhtmlXTreeObject.prototype._prevPageCall=function(a){tree.deleteChildItems(a._pageData[0].id);a.parentNode.removeChild(a);var b=this._getOpenState(a._pageData[0]);var c=a._pageData[1]-this._epgpsC;if(c<0)c=0;this._parseXMLTree(this,a._pageData[3],a._pageData[0].id,a._pageData[2],null,c);this._redrawFrom(this,a._pageData[0],0);if(b>-1)this._openItem(a._pageData[0]);a._pageData=null};dhtmlXTreeObject.prototype.enableTextSigns=function(a){this._txtimg=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.preventIECaching=function(a){this.no_cashe=convertStringToBoolean(a);this.XMLLoader.rSeed=this.no_cashe};dhtmlXTreeObject.prototype.preventIECashing=dhtmlXTreeObject.prototype.preventIECaching;dhtmlXTreeObject.prototype.disableCheckbox=function(a,b){if(typeof a!="object")var c=this._globalIdStorageFind(a,0,1);else var c=a;if(!c)return;c.dscheck=convertStringToBoolean(b)?(c.checkstate||0)%3+3:c.checkstate>2?c.checkstate-3:c.checkstate;this._setCheck(c);if(c.dscheck<3)c.dscheck=false};dhtmlXTreeObject.prototype.smartRefreshBranch=function(a,b){this._branchUpdate=1;this.smartRefreshItem(a,b)};dhtmlXTreeObject.prototype.smartRefreshItem=function(a,b){var c=this._globalIdStorageFind(a);for(var d=0;d<c.childsCount;d++)c.childNodes[d]._dmark=true;this.waitUpdateXML=true;if(b&&b.exists)this._parse(b,a);else this._loadDynXML(a,b)};dhtmlXTreeObject.prototype.refreshItems=function(a,b){var c=a.toString().split(this.dlmtr);this.waitUpdateXML=new Array;for(var d=0;d<c.length;d++)this.waitUpdateXML[c[d]]=true;this.loadXML((b||this.XMLsource)+getUrlSymbol(b||this.XMLsource)+"ids="+this._escape(a))};dhtmlXTreeObject.prototype.updateItem=function(a,b,c,d,e,f){var g=this._globalIdStorageFind(a);g.userData=new cObject;if(b)g.label=b;g.images=new Array(c||this.imageArray[0],d||this.imageArray[1],e||this.imageArray[2]);this.setItemText(a,b);if(f)this._setCheck(g,true);this._correctPlus(g);g._dmark=false;return g};dhtmlXTreeObject.prototype.setDropHandler=function(a){this.attachEvent("onDrop",a)};dhtmlXTreeObject.prototype.setOnLoadingStart=function(a){this.attachEvent("onXLS",a)};dhtmlXTreeObject.prototype.setOnLoadingEnd=function(a){this.attachEvent("onXLE",a)};dhtmlXTreeObject.prototype.setXMLAutoLoadingBehaviour=function(a){this.xmlalb=a};dhtmlXTreeObject.prototype.enableSmartCheckboxes=function(a){this.smcheck=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.getXMLState=function(){return this.xmlstate==1};dhtmlXTreeObject.prototype.setItemTopOffset=function(a,b){if(typeof a=="string")var c=this._globalIdStorageFind(a);else var c=a;var d=c.span.parentNode.parentNode;c.span.style.paddingBottom="1px";for(var e=0;e<d.childNodes.length;e++){if(e!=0){d.childNodes[e].style.height=18+parseInt(b)+"px"}else{var f=d.childNodes[e].firstChild;if(d.childNodes[e].firstChild.tagName!="DIV"){f=document.createElement("DIV");d.childNodes[e].insertBefore(f,d.childNodes[e].firstChild)}f.style.height=parseInt(b)+"px";if((c.parentObject.id!=this.rootId||c.parentObject.childNodes[0]!=c)&&this.treeLinesOn)f.style.backgroundImage="url("+this.imPath+this.lineArray[5]+")";f.innerHTML=" ";f.style.overflow="hidden";if(parseInt(b)==0)d.childNodes[e].removeChild(f)}d.childNodes[e].style.verticalAlign="bottom";if(_isIE){this.allTree.childNodes[0].border="1";this.allTree.childNodes[0].border="0"}}};dhtmlXTreeObject.prototype.setIconSize=function(a,b,c){if(c){if(c&&c.span)var d=c;else var d=this._globalIdStorageFind(c);if(!d)return 0;var e=d.span.parentNode.previousSibling.childNodes[0];if(a){e.style.width=a;if(window._KHTMLrv)e.parentNode.style.width=a}if(b){e.style.height=b;if(window._KHTMLrv)e.parentNode.style.height=b}}else{this.def_img_x=a;this.def_img_y=b}};dhtmlXTreeObject.prototype.getItemImage=function(a,b,c){var d=this._globalIdStorageFind(a);if(!d)return"";var e=d.images[b||0];if(c)e=this.iconURL+e;return e};dhtmlXTreeObject.prototype.enableRadioButtons=function(a,b){if(arguments.length==1){this._frbtr=convertStringToBoolean(a);this.checkBoxOff=this.checkBoxOff||this._frbtr;return}var c=this._globalIdStorageFind(a);if(!c)return"";b=convertStringToBoolean(b);if(b&&!c._r_logic){c._r_logic=true;for(var d=0;d<c.childsCount;d++)this._setCheck(c.childNodes[d],c.childNodes[d].checkstate)}if(!b&&c._r_logic){c._r_logic=false;for(var d=0;d<c.childsCount;d++)this._setCheck(c.childNodes[d],c.childNodes[d].checkstate)}};dhtmlXTreeObject.prototype.enableSingleRadioMode=function(a){this._frbtrs=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.openOnItemAdded=function(a){this._hAdI=!convertStringToBoolean(a)};dhtmlXTreeObject.prototype.openOnItemAdding=function(a){this._hAdI=!convertStringToBoolean(a)};dhtmlXTreeObject.prototype.enableMultiLineItems=function(a){if(a===true)this.mlitems="100%";else this.mlitems=a};dhtmlXTreeObject.prototype.enableAutoTooltips=function(a){this.ettip=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.clearSelection=function(a){if(a)this._unselectItem(this._globalIdStorageFind(a));else this._unselectItems()};dhtmlXTreeObject.prototype.showItemSign=function(a,b){var c=this._globalIdStorageFind(a);if(!c)return 0;var d=c.span.parentNode.previousSibling.previousSibling.previousSibling;if(!convertStringToBoolean(b)){this._openItem(c);c.closeble=false;c.wsign=true}else{c.closeble=true;c.wsign=false}this._correctPlus(c)};dhtmlXTreeObject.prototype.showItemCheckbox=function(a,b){if(!a)for(var c in this._idpull)this.showItemCheckbox(this._idpull[c],b);if(typeof a!="object")a=this._globalIdStorageFind(a,0,0);if(!a)return 0;a.nocheckbox=!convertStringToBoolean(b);var d=a.span.parentNode.previousSibling.previousSibling.childNodes[0];d.style.display=!a.nocheckbox?"":"none";if(window._KHTMLrv)d.parentNode.style.display=!a.nocheckbox?"":"none"};dhtmlXTreeObject.prototype.setListDelimeter=function(a){this.dlmtr=a};dhtmlXTreeObject.prototype.setEscapingMode=function(a){this.utfesc=a};dhtmlXTreeObject.prototype.enableHighlighting=function(a){this.ehlt=true;this.ehlta=convertStringToBoolean(a)};dhtmlXTreeObject.prototype._itemMouseOut=function(){var a=this.childNodes[3].parentObject;var b=a.treeNod;b.callEvent("onMouseOut",[a.id]);if(a.id==b._l_onMSI)b._l_onMSI=null;if(!b.ehlta)return;a.span.className=a.span.className.replace("_lor","")};dhtmlXTreeObject.prototype._itemMouseIn=function(){var a=this.childNodes[3].parentObject;var b=a.treeNod;if(b._l_onMSI!=a.id)b.callEvent("onMouseIn",[a.id]);b._l_onMSI=a.id;if(!b.ehlta)return;a.span.className=a.span.className.replace("_lor","");a.span.className=a.span.className.replace(/((standart|selected)TreeRow)/,"$1_lor")};dhtmlXTreeObject.prototype.enableActiveImages=function(a){this._aimgs=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.focusItem=function(a){var b=this._globalIdStorageFind(a);if(!b)return 0;this._focusNode(b)};dhtmlXTreeObject.prototype.getAllSubItems=function(a){return this._getAllSubItems(a)};dhtmlXTreeObject.prototype.getAllChildless=function(){return this._getAllScraggyItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllLeafs=dhtmlXTreeObject.prototype.getAllChildless;dhtmlXTreeObject.prototype._getAllScraggyItems=function(a){var b="";for(var c=0;c<a.childsCount;c++){if(a.childNodes[c].unParsed||a.childNodes[c].childsCount>0){if(a.childNodes[c].unParsed)var d=this._getAllScraggyItemsXML(a.childNodes[c].unParsed,1);else var d=this._getAllScraggyItems(a.childNodes[c]);if(d)if(b)b+=this.dlmtr+d;else b=d}else if(!b)b=a.childNodes[c].id;else b+=this.dlmtr+a.childNodes[c].id}return b};dhtmlXTreeObject.prototype._getAllFatItems=function(a){var b="";for(var c=0;c<a.childsCount;c++){if(a.childNodes[c].unParsed||a.childNodes[c].childsCount>0){if(!b)b=a.childNodes[c].id;else b+=this.dlmtr+a.childNodes[c].id;if(a.childNodes[c].unParsed)var d=this._getAllFatItemsXML(a.childNodes[c].unParsed,1);else var d=this._getAllFatItems(a.childNodes[c]);if(d)b+=this.dlmtr+d}}return b};dhtmlXTreeObject.prototype.getAllItemsWithKids=function(){return this._getAllFatItems(this.htmlNode)};dhtmlXTreeObject.prototype.getAllFatItems=dhtmlXTreeObject.prototype.getAllItemsWithKids;dhtmlXTreeObject.prototype.getAllChecked=function(){return this._getAllChecked("","",1)};dhtmlXTreeObject.prototype.getAllUnchecked=function(a){if(a)a=this._globalIdStorageFind(a);return this._getAllChecked(a,"",0)};dhtmlXTreeObject.prototype.getAllPartiallyChecked=function(){return this._getAllChecked("","",2)};dhtmlXTreeObject.prototype.getAllCheckedBranches=function(){var a=this._getAllChecked("","",1);if(a!="")a+=this.dlmtr;return a+this._getAllChecked("","",2)};dhtmlXTreeObject.prototype._getAllChecked=function(a,b,c){if(!a)a=this.htmlNode;if(a.checkstate==c)if(!a.nocheckbox){if(b)b+=this.dlmtr+a.id;else b=a.id}var d=a.childsCount;for(var e=0;e<d;e++){b=this._getAllChecked(a.childNodes[e],b,c)}if(a.unParsed)b=this._getAllCheckedXML(a.unParsed,b,c);if(b)return b;else return""};dhtmlXTreeObject.prototype.setItemStyle=function(a,b,c){var c=c||false;var d=this._globalIdStorageFind(a);if(!d)return 0;if(!d.span.style.cssText)d.span.setAttribute("style",d.span.getAttribute("style")+";"+b);else d.span.style.cssText=c?b:d.span.style.cssText+";"+b};dhtmlXTreeObject.prototype.enableImageDrag=function(a){this._itim_dg=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setOnDragIn=function(a){this.attachEvent("onDragIn",a)};dhtmlXTreeObject.prototype.enableDragAndDropScrolling=function(a){this.autoScroll=convertStringToBoolean(a)};dhtmlXTreeObject.prototype.setSkin=function(a){var b=this.parentObject.className.replace(/dhxtree_[^ ]*/gi,"");this.parentObject.className=b+" dhxtree_"+a};(function(){dhtmlx.extend_api("dhtmlXTreeObject",{_init:function(a){return[a.parent,a.width||"100%",a.height||"100%",a.root_id||0]},auto_save_selection:"enableAutoSavingSelected",auto_tooltip:"enableAutoTooltips",checkbox:"enableCheckBoxes",checkbox_3_state:"enableThreeStateCheckboxes",checkbox_smart:"enableSmartCheckboxes",context_menu:"enableContextMenu",distributed_parsing:"enableDistributedParsing",drag:"enableDragAndDrop",drag_copy:"enableMercyDrag",drag_image:"enableImageDrag",drag_scroll:"enableDragAndDropScrolling",editor:"enableItemEditor",hover:"enableHighlighting",images:"enableTreeImages",image_fix:"enableIEImageFix",image_path:"setImagePath",lines:"enableTreeLines",loading_item:"enableLoadingItem",multiline:"enableMultiLineItems",multiselect:"enableMultiselection",navigation:"enableKeyboardNavigation",radio:"enableRadioButtons",radio_single:"enableSingleRadioMode",rtl:"enableRTL",search:"enableKeySearch",smart_parsing:"enableSmartXMLParsing",smart_rendering:"enableSmartRendering",text_icons:"enableTextSigns",xml:"loadXML",skin:"setSkin"},{})})()
